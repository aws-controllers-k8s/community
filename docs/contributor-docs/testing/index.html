<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300..800&display=swap" rel=stylesheet><link rel=stylesheet href=https://aws-controllers-k8s.github.io/community/main.74ee4778332464876d1ce11c91bbf08f85eefdb48e25d7f43c856768970662c034d6e347f99896b0868b6f484f06b835ea366b57758448fcb4088e8d665591de.css integrity="sha512-dO5HeDMkZIdtHOEckbvwj4Xu/bSOJdf0PIVnaJcGYsA01uNH+ZiWsIaLb0hPBrg16jZrV3WESPy0CI6NZlWR3g==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Testing - ACK</title><meta name=description content="How to test an ACK service controller"><link rel=canonical href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Testing"><meta property="og:description" content="How to test an ACK service controller"><meta property="og:url" content="https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/"><meta property="og:site_name" content="ACK"><meta property="og:image" content="https://aws-controllers-k8s.github.io/community/og.png"><meta property="og:image:alt" content="ACK"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@awscloud"><meta name=twitter:creator content><meta name=twitter:title content="Testing"><meta name=twitter:description content="How to test an ACK service controller"><meta name=twitter:image content="https://aws-controllers-k8s.github.io/community/og.png"><meta name=twitter:image:alt content="Testing"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1","name":"AWS Controllers for K8s","url":"https://aws-controllers-k8s.github.io/","sameAs":["https://twitter.com/awscloud","https://github.com/aws-controllers-k8s/community"],"logo":{"@type":"ImageObject","@id":"https://aws-controllers-k8s.github.io/#/schema/image/1","url":"https://aws-controllers-k8s.github.io/ack.png","width":512,"height":512,"caption":"AWS Controllers for K8s"},"image":{"@id":"https://aws-controllers-k8s.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://aws-controllers-k8s.github.io/#/schema/website/1","url":"https://aws-controllers-k8s.github.io/","name":"ACK","description":"Doks is a Hugo theme helping you build modern documentation websites that are secure, fast, and SEO-ready â€” by default.","publisher":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/","url":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/","name":"Testing","description":"How to test an ACK service controller","isPartOf":{"@id":"https://aws-controllers-k8s.github.io/#/schema/website/1"},"about":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/"]}]},{"@type":"BreadcrumbList","@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/","url":"https://aws-controllers-k8s.github.io/community/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/","url":"https://aws-controllers-k8s.github.io/community/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/","url":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/","name":"Contributor Docs"}},{"@type":"ListItem","position":4,"item":{"@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://aws-controllers-k8s.github.io/#/schema/article/1","headline":"Testing","description":"How to test an ACK service controller","isPartOf":{"@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/"},"mainEntityOfPage":{"@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","author":{"@id":"https://aws-controllers-k8s.github.io/#/schema/person/2"},"publisher":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"},"image":{"@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://aws-controllers-k8s.github.io/#/schema/person/2","name":"AWS","sameAs":["https://twitter.com/awscloud","https://github.com/aws-controllers-k8s"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/#/schema/image/2","url":"https://aws-controllers-k8s.github.io/community/og.png","contentUrl":"https://aws-controllers-k8s.github.io/community/og.png","caption":"Testing"}]}]}</script><meta name=theme-color content="#ff9900"><link rel=apple-touch-icon sizes=180x180 href=https://aws-controllers-k8s.github.io/community/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://aws-controllers-k8s.github.io/community/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://aws-controllers-k8s.github.io/community/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://aws-controllers-k8s.github.io/community/site.webmanifest><link rel=mask-icon color=#5bbad5 href=https://aws-controllers-k8s.github.io/community/safari-pinned-tab.svg><meta name=msapplication-TileColor content="#da532c"><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body class="docs single d-flex flex-column h-100 dark"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" href=https://aws-controllers-k8s.github.io/community/><span class="navbar-logo logo-light"><svg width="30" height="34" viewBox="0 0 64.386 62.635" xmlns="http://www.w3.org/2000/svg"><path d="m18.112 62.241c-.58208-.2097-1.0825-.38307-1.1121-.38526-.05964-.004-6.9703-8.5523-8.016-9.9151-.3638-.47411-1.8521-2.3244-3.3073-4.1118-6.169-7.5771-5.7671-6.894-5.6043-9.525.07652-1.2369.2681-2.6062.42574-3.0427.15763-.43656.88408-3.4726 1.6143-6.7469s1.4423-6.4294 1.5822-7.0115c.13998-.58209.49521-2.1299.78941-3.4396 1.3414-5.9718 1.3876-6.0514 4.3737-7.5406 1.313-.65484 3.9324-1.927 5.8208-2.8269 1.8885-.89995 6.3475-3.0258 9.9091-4.7242 7.7798-3.7099 7.4615-3.6736 12.178-1.3871 1.6735.81137 4.531 2.1853 6.35 3.0532 1.819.86788 4.4384 2.1189 5.8208 2.78 1.3824.66112 3.7644 1.7868 5.2931 2.5015 2.9983 1.4017 4.0296 2.3189 4.4852 3.9889.24392.89408.61395 2.4653 2.1314 9.0501.28504 1.2369.86914 3.7372 1.298 5.5562s.97374 4.2003 1.2108 5.2917c.2371 1.0914.56563 2.4425.73006 3.0024.50213 1.7098.37232 3.363-.34938 4.4494-.35422.53325-2.549 3.3137-4.8774 6.1788-2.3283 2.8651-4.531 5.6016-4.8948 6.0813-3.5052 4.6213-6.5923 8.1362-7.558 8.6052-1.0278.49922-1.6581.52197-14.155.51087-10.7-.01-13.272-.081-14.138-.39289zm14.42-14.853c1.993-.65861 4.1321-1.8055 5.208-2.7923l.57777-.52995.15829 1.0218c.37804 2.4404.25325 2.3447 3.0582 2.3447h2.5072v-12.965c0-14.742.01357-14.637-2.1954-17.096-2.2207-2.4725-5.3026-3.3183-11.157-3.0616-3.7392.16395-6.9101.77913-9.2875 1.8019l-1.3054.56157v2.2164c0 1.219.0817 2.2164.18156 2.2164s1.0226-.23473 2.0505-.52163c2.4182-.67492 6.8343-1.3304 8.9629-1.3304 2.0099.0 4.3168.63112 5.1681 1.4139 1.22 1.1218 1.459 1.9649 1.5795 5.5722.10844 3.2453.08971 3.4049-.37858 3.2252-.27096-.10398-1.6251-.35976-3.0091-.56841-6.4942-.979-10.999.005-14.067 3.0735-2.0011 2.0011-2.4548 3.2402-2.4641 6.7305-.0065 2.4258.08634 3.1141.55768 4.1334 1.179 2.5499 3.2925 4.2534 5.9416 4.9794 2.3169.63499 5.0434.52227 7.9127-.42589zm-5.3603-4.4174c-1.3419-.50246-1.7811-.90498-2.3487-2.1529-.96238-2.1156-.37837-5.1724 1.2299-6.4375 1.6643-1.3091 6.0181-1.7402 10.183-1.0084l1.7198.30217v6.6092l-1.4496.86623c-3.1522 1.8836-7.1071 2.6552-9.3347 1.8212z" stroke-width=".26458" style="fill:#212529"/><path style="fill:none;stroke-width:.271169" d="m97.026736 181.42372c-11.841729-2.08439-21.332462-9.10215-26.093859-19.29466-1.998022-4.27707-2.054194-4.6839-2.055098-14.88419-841e-6-9.49243.144169-11.16725 1.267846-14.64314 1.712817-5.29828 6.177554-10.936 12.299033-15.53024 2.542552-1.90822 7.390509-4.53026 10.594967-5.73033 8.933335-3.34556 20.674605-4.18152 34.409895-2.44995 4.41785.55695 12.65266 1.97363 14.19738 2.44244 1.76241.53489 1.85502.50959 2.22367-.60744.24279-.73566.28029-2.73516.14369-7.66053-.44788-16.149002-1.23751-19.911778-5.02917-23.965076-1.80821-1.932978-3.56225-2.973051-7.11557-4.219231-5.30124-1.859191-12.26098-2.569875-19.19872-1.960452-10.49153.921594-19.993865 2.573896-30.430988 5.291456l-5.619006 1.463045-.198978-.992725C76.31239 78.136699 76.217381 74.401849 76.210696 70.38303l-.01215-7.306943 3.356503-1.444983c10.517529-4.527823 21.216871-6.656502 37.293351-7.419665 12.51101-.593907 22.76653.582675 29.54824 3.389974 4.64166 1.921419 7.46417 3.920688 11.49419 8.14168 5.92808 6.208991 7.10885 9.292714 7.94906 20.759878.20234 2.761617.35353 19.385439.44083 48.471489l.13286 44.26837-6.87266-.008c-7.35796-.009-10.40797-.26157-11.45694-.94889-1.06894-.70039-1.56607-2.17132-2.37024-7.01314-.41845-2.51943-.81979-4.63975-.89185-4.71182-.0721-.0721-.94053.61073-1.92991 1.51732-2.61666 2.39769-6.17638 4.67392-11.10375 7.10019-7.00303 3.44832-13.15672 5.41292-19.90153 6.35366-4.14851.57862-11.25229.52696-14.85996-.10807zM117.9586 163.14859c7.66738-1.41157 14.24402-3.97835 21.89691-8.5461l3.72858-2.22546v-12.58107c0-11.74762-.0314-12.59038-.47455-12.72168-1.42309-.42168-10.77757-1.80215-14.1221-2.08405-4.68265-.39467-14.28993-.18758-17.80807.38387-8.70887 1.41459-13.028171 3.55254-15.811026 7.82606-2.230704 3.42561-3.30745 7.4555-3.304504 12.36763.0032 5.38208 1.685615 10.33001 4.555689 13.39835 1.872987 2.00238 6.082191 3.96008 9.779001 4.54822 2.10281.33454 8.92935.11855 11.56007-.36577z" transform="scale(0.26458333)"/></svg></span><span class="navbar-logo logo-dark d-none"><svg width="30" height="34" viewBox="0 0 64.386 62.635" xmlns="http://www.w3.org/2000/svg"><path d="m18.112 62.241c-.58208-.2097-1.0825-.38307-1.1121-.38526-.05964-.004-6.9703-8.5523-8.016-9.9151-.3638-.47411-1.8521-2.3244-3.3073-4.1118-6.169-7.5771-5.7671-6.894-5.6043-9.525.07652-1.2369.2681-2.6062.42574-3.0427.15763-.43656.88408-3.4726 1.6143-6.7469s1.4423-6.4294 1.5822-7.0115c.13998-.58209.49521-2.1299.78941-3.4396 1.3414-5.9718 1.3876-6.0514 4.3737-7.5406 1.313-.65484 3.9324-1.927 5.8208-2.8269 1.8885-.89995 6.3475-3.0258 9.9091-4.7242 7.7798-3.7099 7.4615-3.6736 12.178-1.3871 1.6735.81137 4.531 2.1853 6.35 3.0532 1.819.86788 4.4384 2.1189 5.8208 2.78 1.3824.66112 3.7644 1.7868 5.2931 2.5015 2.9983 1.4017 4.0296 2.3189 4.4852 3.9889.24392.89408.61395 2.4653 2.1314 9.0501.28504 1.2369.86914 3.7372 1.298 5.5562s.97374 4.2003 1.2108 5.2917c.2371 1.0914.56563 2.4425.73006 3.0024.50213 1.7098.37232 3.363-.34938 4.4494-.35422.53325-2.549 3.3137-4.8774 6.1788-2.3283 2.8651-4.531 5.6016-4.8948 6.0813-3.5052 4.6213-6.5923 8.1362-7.558 8.6052-1.0278.49922-1.6581.52197-14.155.51087-10.7-.01-13.272-.081-14.138-.39289zm14.42-14.853c1.993-.65861 4.1321-1.8055 5.208-2.7923l.57777-.52995.15829 1.0218c.37804 2.4404.25325 2.3447 3.0582 2.3447h2.5072v-12.965c0-14.742.01357-14.637-2.1954-17.096-2.2207-2.4725-5.3026-3.3183-11.157-3.0616-3.7392.16395-6.9101.77913-9.2875 1.8019l-1.3054.56157v2.2164c0 1.219.0817 2.2164.18156 2.2164s1.0226-.23473 2.0505-.52163c2.4182-.67492 6.8343-1.3304 8.9629-1.3304 2.0099.0 4.3168.63112 5.1681 1.4139 1.22 1.1218 1.459 1.9649 1.5795 5.5722.10844 3.2453.08971 3.4049-.37858 3.2252-.27096-.10398-1.6251-.35976-3.0091-.56841-6.4942-.979-10.999.005-14.067 3.0735-2.0011 2.0011-2.4548 3.2402-2.4641 6.7305-.0065 2.4258.08634 3.1141.55768 4.1334 1.179 2.5499 3.2925 4.2534 5.9416 4.9794 2.3169.63499 5.0434.52227 7.9127-.42589zm-5.3603-4.4174c-1.3419-.50246-1.7811-.90498-2.3487-2.1529-.96238-2.1156-.37837-5.1724 1.2299-6.4375 1.6643-1.3091 6.0181-1.7402 10.183-1.0084l1.7198.30217v6.6092l-1.4496.86623c-3.1522 1.8836-7.1071 2.6552-9.3347 1.8212z" stroke-width=".26458" style="fill:#fff"/><path style="fill:none;stroke-width:.271169" d="m97.026736 181.42372c-11.841729-2.08439-21.332462-9.10215-26.093859-19.29466-1.998022-4.27707-2.054194-4.6839-2.055098-14.88419-841e-6-9.49243.144169-11.16725 1.267846-14.64314 1.712817-5.29828 6.177554-10.936 12.299033-15.53024 2.542552-1.90822 7.390509-4.53026 10.594967-5.73033 8.933335-3.34556 20.674605-4.18152 34.409895-2.44995 4.41785.55695 12.65266 1.97363 14.19738 2.44244 1.76241.53489 1.85502.50959 2.22367-.60744.24279-.73566.28029-2.73516.14369-7.66053-.44788-16.149002-1.23751-19.911778-5.02917-23.965076-1.80821-1.932978-3.56225-2.973051-7.11557-4.219231-5.30124-1.859191-12.26098-2.569875-19.19872-1.960452-10.49153.921594-19.993865 2.573896-30.430988 5.291456l-5.619006 1.463045-.198978-.992725C76.31239 78.136699 76.217381 74.401849 76.210696 70.38303l-.01215-7.306943 3.356503-1.444983c10.517529-4.527823 21.216871-6.656502 37.293351-7.419665 12.51101-.593907 22.76653.582675 29.54824 3.389974 4.64166 1.921419 7.46417 3.920688 11.49419 8.14168 5.92808 6.208991 7.10885 9.292714 7.94906 20.759878.20234 2.761617.35353 19.385439.44083 48.471489l.13286 44.26837-6.87266-.008c-7.35796-.009-10.40797-.26157-11.45694-.94889-1.06894-.70039-1.56607-2.17132-2.37024-7.01314-.41845-2.51943-.81979-4.63975-.89185-4.71182-.0721-.0721-.94053.61073-1.92991 1.51732-2.61666 2.39769-6.17638 4.67392-11.10375 7.10019-7.00303 3.44832-13.15672 5.41292-19.90153 6.35366-4.14851.57862-11.25229.52696-14.85996-.10807zM117.9586 163.14859c7.66738-1.41157 14.24402-3.97835 21.89691-8.5461l3.72858-2.22546v-12.58107c0-11.74762-.0314-12.59038-.47455-12.72168-1.42309-.42168-10.77757-1.80215-14.1221-2.08405-4.68265-.39467-14.28993-.18758-17.80807.38387-8.70887 1.41459-13.028171 3.55254-15.811026 7.82606-2.230704 3.42561-3.30745 7.4555-3.304504 12.36763.0032 5.38208 1.685615 10.33001 4.555689 13.39835 1.872987 2.00238 6.082191 3.96008 9.779001 4.54822 2.10281.33454 8.92935.11855 11.56007-.36577z" transform="scale(0.26458333)"/></svg></span></a><button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/aws-controllers-k8s/community><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav flex-grow-1 main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://aws-controllers-k8s.github.io/community/docs/community/overview/>Documentation</a></li><li class=nav-item><a class=nav-link href=https://aws-controllers-k8s.github.io/community/reference/>API Reference</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-introduction aria-expanded=true>
Introduction</button><div class="collapse show" id=section-introduction><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/overview/>Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/how-it-works/>How it Works</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/services/>Services</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/releases/>Release Phases</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-getting-started aria-expanded=true>
Getting Started</button><div class="collapse show" id=section-getting-started><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/install/>Install an ACK Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/irsa/>Configure IAM Permissions</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/resource-crud/>Create an ACK Resource</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/multi-region-resource-management/>Manage Resources In Multiple Regions</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/cross-account-resource-management/>Manage Resources In Multiple AWS Accounts</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/authorization/>Permissions Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/authentication/>Authentication and Credentials</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/field-export/>Copy a resource field into a ConfigMap or Secret</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/openshift/>Red Hat OpenShift</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/cleanup/>Uninstall an ACK Controller</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-tutorials aria-expanded=true>
Tutorials</button><div class="collapse show" id=section-tutorials><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/sagemaker-example/>Machine Learning with the ACK SageMaker Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/>Scale SageMaker Workloads with Application Auto Scaling</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/rds-example/>Deploy PostgreSQL + MariaDB Instances Using the ACK RDS Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/apigatewayv2-reference-example/>Manage HTTP APIs with the ACK APIGatewayv2 Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/>Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-contributor aria-expanded=true>
Contributor Docs</button><div class="collapse show" id=section-contributor><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/overview/>Contribution Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/tenets/>Project Tenets</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/code-generation/>Code Generation</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/code-organization/>Code Organization</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/api-inference/>API Inference</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/setup/>Setup</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/building-controller/>Building a Controller</a></li><li><a class="docs-link rounded active" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/>Testing</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/release/>Release</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-discussion aria-expanded=true>
Discussion</button><div class="collapse show" id=section-discussion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/background/>Background</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/faq/>FAQ</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/discussions/>Discussions</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><hr><span class=small><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#run-tests>Run tests</a><ul><li><a href=#iam-setup>IAM setup</a></li><li><a href=#run-end-to-end-test>Run end-to-end test</a></li><li><a href=#background>Background</a></li></ul></li><li><a href=#clean-up>Clean up</a></li></ul></nav></span></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Testing</h1><p class=lead></p><p>In the following, we will take you through the steps to run end-to-end (e2e)
tests for the ACK service controller for S3. You may use these steps to run e2e
tests for other ACK service controllers.</p><p>If you run into any problems when testing a service controller, please
<a href=https://github.com/aws-controllers-k8s/community/issues/new/choose>raise an issue</a>
with the details so we can reproduce your issue.</p><h2 id=prerequisites>Prerequisites<a href=#prerequisites class=anchor aria-hidden=true>#</a></h2><p>For local development and testing we use &ldquo;Kubernetes in Docker&rdquo; (<code>kind</code>),
which in turn requires Docker.</p><div class="hint d-flex flex-column border-start my-4 border-4 hint-warning"><div class="hint-title p-2 flex flex-row flex-items-center">Footprint</div><div class="hint-body p-2 small">When you run the <code>scripts/kind-build-test.sh</code> script the first time,
the step that builds the container image for the target ACK service
controller can take up to 40 or more minutes. This is because the container image
contains a lot of dependencies. Once you successfully build the target
image this base image layer is cached locally, and the build takes a much
shorter amount of time. We are aware of this (and the storage footprint,
ca. 3 GB) and aim to reduce both in the fullness of time.</div></div><p>In summary, in order to test ACK you will need to have the following tools
installed and configured:</p><ol><li><a href=https://golang.org/doc/install>Golang 1.14+</a></li><li><code>make</code></li><li><a href=https://docs.docker.com/get-docker/>Docker</a></li><li><a href=https://kind.sigs.k8s.io/docs/user/quick-start/>kind</a></li><li><a href=https://github.com/stedolan/jq/wiki/Installation>jq</a></li></ol><p>To build and test an ACK controller with <code>kind</code>, execute the commands as
described in the following from the root directory of the
<code>github.com/aws-controllers-k8s/test-infra</code> repository.</p><p>You should have forked this repository and <code>git clone</code>&rsquo;d it locally when
<a href=../setup/>setting up your development environment</a>.</p><div class="hint d-flex flex-column border-start my-4 border-4 hint-info"><div class="hint-title p-2 flex flex-row flex-items-center">Recommended RAM</div><div class="hint-body p-2 small">Given that our test setup creates the container images and then launches
a test cluster, we recommend that you have at least 4GB of RAM available
for the tests.</div></div><p>With the prerequisites out of the way, let&rsquo;s move on to running e2e tests for a
service controller.</p><h2 id=run-tests>Run tests<a href=#run-tests class=anchor aria-hidden=true>#</a></h2><p>Time to run the end-to-end test.</p><h3 id=iam-setup>IAM setup<a href=#iam-setup class=anchor aria-hidden=true>#</a></h3><p>In order for the ACK service controller to manage the S3 bucket, it needs an
identity. In other words, it needs an IAM role that represents the ACK service
controller towards the S3 service.</p><p>First, define the name of the IAM role that will have the permission to manage
S3 buckets on your behalf:</p><pre><code class=language-bash>export ACK_TEST_IAM_ROLE=Admin-k8s
</code></pre><p>Now we need to verify the IAM principal (likely an IAM user) that is going to
assume the IAM role <code>ACK_TEST_IAM_ROLE</code>. So to get its ARN, execute:</p><pre><code class=language-bash>export ACK_TEST_PRINCIPAL_ARN=$(aws sts get-caller-identity --query 'Arn' --output text)
</code></pre><p>You can verify if that worked using <code>echo $ACK_TEST_PRINCIPAL_ARN</code> and that should
print something along the lines of <code>arn:aws:iam::1234567890121:user/ausername</code>.</p><p>Next up, create the IAM role, adding the necessary trust relationship to the role,
using the following commands:</p><pre><code class=language-bash>cat &gt; trust-policy.json &lt;&lt; EOF
{
	&quot;Version&quot;: &quot;2012-10-17&quot;,
	&quot;Statement&quot;: {
		&quot;Effect&quot;: &quot;Allow&quot;,
		&quot;Principal&quot;: {
			&quot;AWS&quot;: &quot;$ACK_TEST_PRINCIPAL_ARN&quot;
		},
		&quot;Action&quot;: &quot;sts:AssumeRole&quot;
	}
}
EOF
</code></pre><p>Using above trust policy, we can now create the IAM role:</p><pre><code class=language-bash>aws iam create-role \
    --role-name $ACK_TEST_IAM_ROLE \
    --assume-role-policy-document file://trust-policy.json
</code></pre><p>Now we&rsquo;re in the position to give the IAM role <code>ACK_TEST_IAM_ROLE</code> the permission
to handle S3 buckets for us, using:</p><pre><code class=language-bash>aws iam attach-role-policy \
    --role-name $ACK_TEST_IAM_ROLE \
    --policy-arn &quot;arn:aws:iam::aws:policy/AmazonS3FullAccess&quot;
</code></pre><div class="hint d-flex flex-column border-start my-4 border-4"><div class="hint-title p-2 flex flex-row flex-items-center">Access delegation in IAM</div><div class="hint-body p-2 small">If you&rsquo;re not that familiar with IAM access delegation, we recommend you
to peruse the <a href=https://docs.aws.amazon.com/IAM/latest/UserGuide/tutorial_cross-account-with-roles.html>IAM documentation</a></div></div><p>Next, in order for our test to generate <a href=https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html>temporary credentials</a>
we need to tell it to use the IAM role we created in the previous step.
To generate the IAM role ARN, do:</p><pre><code class=language-bash>AWS_ACCOUNT_ID=$(aws sts get-caller-identity --query 'Account' --output text) &amp;&amp; \
export ACK_ROLE_ARN=arn:aws:iam::${AWS_ACCOUNT_ID}:role/${ACK_TEST_IAM_ROLE}
</code></pre><div class="hint d-flex flex-column border-start my-4 border-4 hint-info"><div class="hint-title p-2 flex flex-row flex-items-center">Note</div><div class="hint-body p-2 small">The tests uses the <code>generate_temp_creds</code> function from the
<code>scripts/lib/aws.sh</code> script, executing effectively
<code>aws sts assume-role --role-session-arn $ACK_ROLE_ARN --role-session-name $TEMP_ROLE</code>
which fetches temporarily <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code>,
and an <code>AWS_SESSION_TOKEN</code> used in turn to authentication the ACK
controller. The duration of the session token is 900 seconds (15 minutes).</div></div><p>Phew that was a lot to set up, but good news: you&rsquo;re almost there.</p><h3 id=run-end-to-end-test>Run end-to-end test<a href=#run-end-to-end-test class=anchor aria-hidden=true>#</a></h3><p>Before you proceed, make sure that you&rsquo;ve done the IAM setup in the previous
step.</p><div class="hint d-flex flex-column border-start my-4 border-4 hint-warning"><div class="hint-title p-2 flex flex-row flex-items-center">IAM troublesâ€½</div><div class="hint-body p-2 small">If you try the following command and you see an error message containing
something along the line of <code>ACK_ROLE_ARN is not defined.</code> then you know
that somewhere in the IAM setup you either left out a step or one of the
commands failed.</div></div><p>Now we&rsquo;re finally in the position to execute the end-to-end test:</p><pre><code class=language-bash>make kind-test SERVICE=$SERVICE
</code></pre><p>This provisions a Kubernetes cluster using <code>kind</code>, builds a container image with
the ACK service controller, and loads the container image into the <code>kind</code> cluster.</p><p>It then installs the ACK service controller and related Kubernetes manifests into
the <code>kind</code> cluster using <code>kustomize build | kubectl apply -f -</code>.</p><p>Then, the above script runs a series of test scripts that call <code>kubectl</code>
and the <code>aws</code> CLI tools to verify that custom resources of the type managed by
the respective ACK service controller is created, updated and deleted
appropriately (still TODO).</p><p>Finally, it will run tests that create resources for the respective service
and verify if the resource has successfully created. In our example case it
should create an S3 bucket and then destroy it again, yielding something like
the following (edited down to the relevant parts):</p><pre><code class=language-bash>...
./scripts/kind-build-test.sh -s s3
Using Kubernetes kindest/node:v1.16.9@sha256:7175872357bc85847ec4b1aba46ed1d12fa054c83ac7a8a11f5c268957fd5765
Creating k8s cluster using &quot;kind&quot; ...
No kind clusters found.
Created k8s cluster using &quot;kind&quot;
Building s3 docker image
Building 's3' controller docker image with tag: ack-s3-controller:ec452ed
sha256:c9cbcc028f2b7351d0507f8542ab88c80f9fb5a3b8b800feee8e362882833eef
Loading the images into the cluster
Image: &quot;ack-s3-controller:ec452ed&quot; with ID &quot;sha256:c9cbcc028f2b7351d0507f8542ab88c80f9fb5a3b8b800feee8e362882833eef&quot; not yet present on node &quot;test-ccc3c7f1-worker&quot;, loading...
Image: &quot;ack-s3-controller:ec452ed&quot; with ID &quot;sha256:c9cbcc028f2b7351d0507f8542ab88c80f9fb5a3b8b800feee8e362882833eef&quot; not yet present on node &quot;test-ccc3c7f1-control-plane&quot;, loading...
Loading CRD manifests for s3 into the cluster
customresourcedefinition.apiextensions.k8s.io/buckets.s3.services.k8s.aws created
Loading RBAC manifests for s3 into the cluster
clusterrole.rbac.authorization.k8s.io/ack-controller-role created
clusterrolebinding.rbac.authorization.k8s.io/ack-controller-rolebinding created
Loading service controller Deployment for s3 into the cluster
2020/08/18 09:51:46 Fixed the missing field by adding apiVersion: kustomize.config.k8s.io/v1beta1
Fixed the missing field by adding kind: Kustomization
namespace/ack-system created
deployment.apps/ack-s3-controller created
Running aws sts assume-role --role-arn arn:aws:iam::1234567890121:role/Admin-k8s, --role-session-name tmp-role-1b779de5  --duration-seconds 900,
Temporary credentials generated
deployment.apps/ack-s3-controller env updated
Added AWS Credentials to env vars map
======================================================================================================
To poke around your test manually:
export KUBECONFIG=/Users/hausenbl/ACK/upstream/aws-controllers-k8s/scripts/../build/tmp-test-ccc3c7f1/kubeconfig
kubectl get pods -A
======================================================================================================
bucket.s3.services.k8s.aws/ack-test-smoke-s3 created
{
  &quot;Name&quot;: &quot;ack-test-smoke-s3&quot;,
  &quot;CreationDate&quot;: &quot;2020-08-18T08:52:04+00:00&quot;
}
bucket.s3.services.k8s.aws &quot;ack-test-smoke-s3&quot; deleted
smoke took 27 second(s)
ðŸ¥‘ Deleting k8s cluster using &quot;kind&quot;
Deleting cluster &quot;test-ccc3c7f1&quot; ...
</code></pre><p>As you can see, in above case the end-to-end test (creating cluster, deploying
ACK, applying custom resources, and tear-down) took less than 30 seconds. This
is for the warmed caches case.</p><h4 id=repeat-for-other-services>Repeat for other services<a href=#repeat-for-other-services class=anchor aria-hidden=true>#</a></h4><p>We have end-to-end tests for all services listed in the <code>DEVELOPER-PREVIEW</code>,
<code>BETA</code> and <code>GA</code> release statuses in our <a href=../../community/services>service listing</a>
document. Simply replace your <code>SERVICE</code> environment variable with the name of a
supported service and re-run the IAM and test steps outlined above.</p><h3 id=background>Background<a href=#background class=anchor aria-hidden=true>#</a></h3><p>We use <a href=https://github.com/vektra/mockery>mockery</a> for unit testing.
You can install it by following the guideline on mockery&rsquo;s GitHub or simply
by running our handy script at <code>./scripts/install-mockery.sh</code> for general
Linux environments.</p><p>We track testing in the umbrella <a href=https://github.com/aws-controllers-k8s/community/issues/6>issue 6</a>.
on GitHub. Use this issue as a starting point and if you create a new
testing-related issue, mention it from there.</p><h2 id=clean-up>Clean up<a href=#clean-up class=anchor aria-hidden=true>#</a></h2><p>To clean up a <code>kind</code> cluster, including the container images and configuration
files created by the script specifically for said test cluster, execute:</p><pre><code class=language-bash>kind delete cluster --name $CLUSTER_NAME
</code></pre><p>If you want to delete all <code>kind</code> cluster running on your machine, use:</p><pre><code class=language-bash>make delete-all-kind-clusters
</code></pre><p>With this the testing is completed. Thanks for your time and we appreciate your
feedback.</p><p class=edit-page><a href=https://github.com/aws-controllers-k8s/community/blob/main/docs/content/docs/contributor-docs/testing.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class=my-n3></div></main></div></div></div><footer class="footer mt-auto text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://aws-controllers-k8s.github.io/community/js/bootstrap.min.586171fec3966d1a44fa8aa2edb24b861dc3a72be8cc24aa4e0dabe4c312a0dae5fe1eaa7c93180a6211fa4d7c5461b0d228fdf741be2eae279a376dfa1e7d81.js integrity="sha512-WGFx/sOWbRpE+oqi7bJLhh3DpyvozCSqTg2r5MMSoNrl/h6qfJMYCmIR+k18VGGw0ij990G+Lq4nmjdt+h59gQ==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/js/highlight.min.b9c3f53f62ede0586acf2866d3772ea55bf34115611a96523af51b289a2a58f9f60b82ffd4103276a6adc1a3bc7113c6ead0cf0799144d35605ff1e9108981bc.js integrity="sha512-ucP1P2Lt4Fhqzyhm03cupVvzQRVhGpZSOvUbKJoqWPn2C4L/1BAydqatwaO8cRPG6tDPB5kUTTVgX/HpEImBvA==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/main.min.491f43bd0e1cabe525a61ecfcb2738d89c578585b04b9ebbaf9d125b55595f3b76e5497375a1da0c840e16966c9a910aae60fba0790088c7869bee07c3be997c.js integrity="sha512-SR9DvQ4cq+Ulph7Pyyc42JxXhYWwS567r50SW1VZXzt25UlzdaHaDIQOFpZsmpEKrmD7oHkAiMeGm+4Hw76ZfA==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/index.min.5fa1929e673d1990c144b1af6971816758f1141d31dc72bcdc5d65c3d0c38ede5b6b6383e53707feffa5a3551ecb97f87ac064c115764cefdebbd16a3f15b55d.js integrity="sha512-X6GSnmc9GZDBRLGvaXGBZ1jxFB0x3HK83F1lw9DDjt5ba2OD5TcH/v+lo1Uey5f4esBkwRV2TO/eu9FqPxW1XQ==" crossorigin=anonymous defer></script></body></html>