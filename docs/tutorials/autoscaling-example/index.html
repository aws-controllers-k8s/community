<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300..800&display=swap" rel=stylesheet><link rel=stylesheet href=https://aws-controllers-k8s.github.io/community/main.8b089da1410751a603b49ebe0b9cdae122a954f9aed2e69fa8868ae419d857d9427e831419d6d7bd3ada371a74f6961b982ef3bfe899e2458780aa806398f0b7.css integrity="sha512-iwidoUEHUaYDtJ6+C5za4SKpVPmu0uafqIaK5BnYV9lCfoMUGdbXvTraNxp09pYbmC7zv+iZ4kWHgKqAY5jwtw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Scale SageMaker Workloads with Application Auto Scaling - ACK</title><meta name=description content="Scale a SageMaker endpoint with the ACK Application Auto Scaling service controller"><link rel=canonical href=https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Scale SageMaker Workloads with Application Auto Scaling"><meta property="og:description" content="Scale a SageMaker endpoint with the ACK Application Auto Scaling service controller"><meta property="og:url" content="https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/"><meta property="og:site_name" content="ACK"><meta property="og:image" content="https://aws-controllers-k8s.github.io/community/og.png"><meta property="og:image:alt" content="ACK"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@awscloud"><meta name=twitter:creator content><meta name=twitter:title content="Scale SageMaker Workloads with Application Auto Scaling"><meta name=twitter:description content="Scale a SageMaker endpoint with the ACK Application Auto Scaling service controller"><meta name=twitter:image content="https://aws-controllers-k8s.github.io/community/og.png"><meta name=twitter:image:alt content="Scale SageMaker Workloads with Application Auto Scaling"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1","name":"AWS Controllers for K8s","url":"https://aws-controllers-k8s.github.io/","sameAs":["https://twitter.com/awscloud","https://github.com/aws-controllers-k8s/community"],"logo":{"@type":"ImageObject","@id":"https://aws-controllers-k8s.github.io/#/schema/image/1","url":"https://aws-controllers-k8s.github.io/ack.png","width":512,"height":512,"caption":"AWS Controllers for K8s"},"image":{"@id":"https://aws-controllers-k8s.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://aws-controllers-k8s.github.io/#/schema/website/1","url":"https://aws-controllers-k8s.github.io/","name":"ACK","description":"Doks is a Hugo theme helping you build modern documentation websites that are secure, fast, and SEO-ready â€” by default.","publisher":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/","url":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/","name":"Scale SageMaker Workloads with Application Auto Scaling","description":"Scale a SageMaker endpoint with the ACK Application Auto Scaling service controller","isPartOf":{"@id":"https://aws-controllers-k8s.github.io/#/schema/website/1"},"about":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/"]}]},{"@type":"BreadcrumbList","@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/","url":"https://aws-controllers-k8s.github.io/community/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/","url":"https://aws-controllers-k8s.github.io/community/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/","url":"https://aws-controllers-k8s.github.io/community/docs/tutorials/","name":"Tutorials"}},{"@type":"ListItem","position":4,"item":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://aws-controllers-k8s.github.io/#/schema/article/1","headline":"Scale SageMaker Workloads with Application Auto Scaling","description":"Scale a SageMaker endpoint with the ACK Application Auto Scaling service controller","isPartOf":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/"},"mainEntityOfPage":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","author":{"@id":"https://aws-controllers-k8s.github.io/#/schema/person/2"},"publisher":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"},"image":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://aws-controllers-k8s.github.io/#/schema/person/2","name":"AWS","sameAs":["https://twitter.com/awscloud","https://github.com/aws-controllers-k8s"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/#/schema/image/2","url":"https://aws-controllers-k8s.github.io/community/og.png","contentUrl":"https://aws-controllers-k8s.github.io/community/og.png","caption":"Scale SageMaker Workloads with Application Auto Scaling"}]}]}</script><meta name=theme-color content="#ff9900"><link rel=apple-touch-icon sizes=180x180 href=https://aws-controllers-k8s.github.io/community/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://aws-controllers-k8s.github.io/community/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://aws-controllers-k8s.github.io/community/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://aws-controllers-k8s.github.io/community/site.webmanifest><link rel=mask-icon color=#5bbad5 href=https://aws-controllers-k8s.github.io/community/safari-pinned-tab.svg><meta name=msapplication-TileColor content="#da532c"><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body class="docs single d-flex flex-column h-100 dark"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" href=https://aws-controllers-k8s.github.io/community/><span class="navbar-logo logo-light"><svg width="30" height="34" viewBox="0 0 64.386 62.635" xmlns="http://www.w3.org/2000/svg"><path d="m18.112 62.241c-.58208-.2097-1.0825-.38307-1.1121-.38526-.05964-.004-6.9703-8.5523-8.016-9.9151-.3638-.47411-1.8521-2.3244-3.3073-4.1118-6.169-7.5771-5.7671-6.894-5.6043-9.525.07652-1.2369.2681-2.6062.42574-3.0427.15763-.43656.88408-3.4726 1.6143-6.7469s1.4423-6.4294 1.5822-7.0115c.13998-.58209.49521-2.1299.78941-3.4396 1.3414-5.9718 1.3876-6.0514 4.3737-7.5406 1.313-.65484 3.9324-1.927 5.8208-2.8269 1.8885-.89995 6.3475-3.0258 9.9091-4.7242 7.7798-3.7099 7.4615-3.6736 12.178-1.3871 1.6735.81137 4.531 2.1853 6.35 3.0532 1.819.86788 4.4384 2.1189 5.8208 2.78 1.3824.66112 3.7644 1.7868 5.2931 2.5015 2.9983 1.4017 4.0296 2.3189 4.4852 3.9889.24392.89408.61395 2.4653 2.1314 9.0501.28504 1.2369.86914 3.7372 1.298 5.5562s.97374 4.2003 1.2108 5.2917c.2371 1.0914.56563 2.4425.73006 3.0024.50213 1.7098.37232 3.363-.34938 4.4494-.35422.53325-2.549 3.3137-4.8774 6.1788-2.3283 2.8651-4.531 5.6016-4.8948 6.0813-3.5052 4.6213-6.5923 8.1362-7.558 8.6052-1.0278.49922-1.6581.52197-14.155.51087-10.7-.01-13.272-.081-14.138-.39289zm14.42-14.853c1.993-.65861 4.1321-1.8055 5.208-2.7923l.57777-.52995.15829 1.0218c.37804 2.4404.25325 2.3447 3.0582 2.3447h2.5072v-12.965c0-14.742.01357-14.637-2.1954-17.096-2.2207-2.4725-5.3026-3.3183-11.157-3.0616-3.7392.16395-6.9101.77913-9.2875 1.8019l-1.3054.56157v2.2164c0 1.219.0817 2.2164.18156 2.2164s1.0226-.23473 2.0505-.52163c2.4182-.67492 6.8343-1.3304 8.9629-1.3304 2.0099.0 4.3168.63112 5.1681 1.4139 1.22 1.1218 1.459 1.9649 1.5795 5.5722.10844 3.2453.08971 3.4049-.37858 3.2252-.27096-.10398-1.6251-.35976-3.0091-.56841-6.4942-.979-10.999.005-14.067 3.0735-2.0011 2.0011-2.4548 3.2402-2.4641 6.7305-.0065 2.4258.08634 3.1141.55768 4.1334 1.179 2.5499 3.2925 4.2534 5.9416 4.9794 2.3169.63499 5.0434.52227 7.9127-.42589zm-5.3603-4.4174c-1.3419-.50246-1.7811-.90498-2.3487-2.1529-.96238-2.1156-.37837-5.1724 1.2299-6.4375 1.6643-1.3091 6.0181-1.7402 10.183-1.0084l1.7198.30217v6.6092l-1.4496.86623c-3.1522 1.8836-7.1071 2.6552-9.3347 1.8212z" stroke-width=".26458" style="fill:#212529"/><path style="fill:none;stroke-width:.271169" d="m97.026736 181.42372c-11.841729-2.08439-21.332462-9.10215-26.093859-19.29466-1.998022-4.27707-2.054194-4.6839-2.055098-14.88419-841e-6-9.49243.144169-11.16725 1.267846-14.64314 1.712817-5.29828 6.177554-10.936 12.299033-15.53024 2.542552-1.90822 7.390509-4.53026 10.594967-5.73033 8.933335-3.34556 20.674605-4.18152 34.409895-2.44995 4.41785.55695 12.65266 1.97363 14.19738 2.44244 1.76241.53489 1.85502.50959 2.22367-.60744.24279-.73566.28029-2.73516.14369-7.66053-.44788-16.149002-1.23751-19.911778-5.02917-23.965076-1.80821-1.932978-3.56225-2.973051-7.11557-4.219231-5.30124-1.859191-12.26098-2.569875-19.19872-1.960452-10.49153.921594-19.993865 2.573896-30.430988 5.291456l-5.619006 1.463045-.198978-.992725C76.31239 78.136699 76.217381 74.401849 76.210696 70.38303l-.01215-7.306943 3.356503-1.444983c10.517529-4.527823 21.216871-6.656502 37.293351-7.419665 12.51101-.593907 22.76653.582675 29.54824 3.389974 4.64166 1.921419 7.46417 3.920688 11.49419 8.14168 5.92808 6.208991 7.10885 9.292714 7.94906 20.759878.20234 2.761617.35353 19.385439.44083 48.471489l.13286 44.26837-6.87266-.008c-7.35796-.009-10.40797-.26157-11.45694-.94889-1.06894-.70039-1.56607-2.17132-2.37024-7.01314-.41845-2.51943-.81979-4.63975-.89185-4.71182-.0721-.0721-.94053.61073-1.92991 1.51732-2.61666 2.39769-6.17638 4.67392-11.10375 7.10019-7.00303 3.44832-13.15672 5.41292-19.90153 6.35366-4.14851.57862-11.25229.52696-14.85996-.10807zM117.9586 163.14859c7.66738-1.41157 14.24402-3.97835 21.89691-8.5461l3.72858-2.22546v-12.58107c0-11.74762-.0314-12.59038-.47455-12.72168-1.42309-.42168-10.77757-1.80215-14.1221-2.08405-4.68265-.39467-14.28993-.18758-17.80807.38387-8.70887 1.41459-13.028171 3.55254-15.811026 7.82606-2.230704 3.42561-3.30745 7.4555-3.304504 12.36763.0032 5.38208 1.685615 10.33001 4.555689 13.39835 1.872987 2.00238 6.082191 3.96008 9.779001 4.54822 2.10281.33454 8.92935.11855 11.56007-.36577z" transform="scale(0.26458333)"/></svg></span><span class="navbar-logo logo-dark d-none"><svg width="30" height="34" viewBox="0 0 64.386 62.635" xmlns="http://www.w3.org/2000/svg"><path d="m18.112 62.241c-.58208-.2097-1.0825-.38307-1.1121-.38526-.05964-.004-6.9703-8.5523-8.016-9.9151-.3638-.47411-1.8521-2.3244-3.3073-4.1118-6.169-7.5771-5.7671-6.894-5.6043-9.525.07652-1.2369.2681-2.6062.42574-3.0427.15763-.43656.88408-3.4726 1.6143-6.7469s1.4423-6.4294 1.5822-7.0115c.13998-.58209.49521-2.1299.78941-3.4396 1.3414-5.9718 1.3876-6.0514 4.3737-7.5406 1.313-.65484 3.9324-1.927 5.8208-2.8269 1.8885-.89995 6.3475-3.0258 9.9091-4.7242 7.7798-3.7099 7.4615-3.6736 12.178-1.3871 1.6735.81137 4.531 2.1853 6.35 3.0532 1.819.86788 4.4384 2.1189 5.8208 2.78 1.3824.66112 3.7644 1.7868 5.2931 2.5015 2.9983 1.4017 4.0296 2.3189 4.4852 3.9889.24392.89408.61395 2.4653 2.1314 9.0501.28504 1.2369.86914 3.7372 1.298 5.5562s.97374 4.2003 1.2108 5.2917c.2371 1.0914.56563 2.4425.73006 3.0024.50213 1.7098.37232 3.363-.34938 4.4494-.35422.53325-2.549 3.3137-4.8774 6.1788-2.3283 2.8651-4.531 5.6016-4.8948 6.0813-3.5052 4.6213-6.5923 8.1362-7.558 8.6052-1.0278.49922-1.6581.52197-14.155.51087-10.7-.01-13.272-.081-14.138-.39289zm14.42-14.853c1.993-.65861 4.1321-1.8055 5.208-2.7923l.57777-.52995.15829 1.0218c.37804 2.4404.25325 2.3447 3.0582 2.3447h2.5072v-12.965c0-14.742.01357-14.637-2.1954-17.096-2.2207-2.4725-5.3026-3.3183-11.157-3.0616-3.7392.16395-6.9101.77913-9.2875 1.8019l-1.3054.56157v2.2164c0 1.219.0817 2.2164.18156 2.2164s1.0226-.23473 2.0505-.52163c2.4182-.67492 6.8343-1.3304 8.9629-1.3304 2.0099.0 4.3168.63112 5.1681 1.4139 1.22 1.1218 1.459 1.9649 1.5795 5.5722.10844 3.2453.08971 3.4049-.37858 3.2252-.27096-.10398-1.6251-.35976-3.0091-.56841-6.4942-.979-10.999.005-14.067 3.0735-2.0011 2.0011-2.4548 3.2402-2.4641 6.7305-.0065 2.4258.08634 3.1141.55768 4.1334 1.179 2.5499 3.2925 4.2534 5.9416 4.9794 2.3169.63499 5.0434.52227 7.9127-.42589zm-5.3603-4.4174c-1.3419-.50246-1.7811-.90498-2.3487-2.1529-.96238-2.1156-.37837-5.1724 1.2299-6.4375 1.6643-1.3091 6.0181-1.7402 10.183-1.0084l1.7198.30217v6.6092l-1.4496.86623c-3.1522 1.8836-7.1071 2.6552-9.3347 1.8212z" stroke-width=".26458" style="fill:#fff"/><path style="fill:none;stroke-width:.271169" d="m97.026736 181.42372c-11.841729-2.08439-21.332462-9.10215-26.093859-19.29466-1.998022-4.27707-2.054194-4.6839-2.055098-14.88419-841e-6-9.49243.144169-11.16725 1.267846-14.64314 1.712817-5.29828 6.177554-10.936 12.299033-15.53024 2.542552-1.90822 7.390509-4.53026 10.594967-5.73033 8.933335-3.34556 20.674605-4.18152 34.409895-2.44995 4.41785.55695 12.65266 1.97363 14.19738 2.44244 1.76241.53489 1.85502.50959 2.22367-.60744.24279-.73566.28029-2.73516.14369-7.66053-.44788-16.149002-1.23751-19.911778-5.02917-23.965076-1.80821-1.932978-3.56225-2.973051-7.11557-4.219231-5.30124-1.859191-12.26098-2.569875-19.19872-1.960452-10.49153.921594-19.993865 2.573896-30.430988 5.291456l-5.619006 1.463045-.198978-.992725C76.31239 78.136699 76.217381 74.401849 76.210696 70.38303l-.01215-7.306943 3.356503-1.444983c10.517529-4.527823 21.216871-6.656502 37.293351-7.419665 12.51101-.593907 22.76653.582675 29.54824 3.389974 4.64166 1.921419 7.46417 3.920688 11.49419 8.14168 5.92808 6.208991 7.10885 9.292714 7.94906 20.759878.20234 2.761617.35353 19.385439.44083 48.471489l.13286 44.26837-6.87266-.008c-7.35796-.009-10.40797-.26157-11.45694-.94889-1.06894-.70039-1.56607-2.17132-2.37024-7.01314-.41845-2.51943-.81979-4.63975-.89185-4.71182-.0721-.0721-.94053.61073-1.92991 1.51732-2.61666 2.39769-6.17638 4.67392-11.10375 7.10019-7.00303 3.44832-13.15672 5.41292-19.90153 6.35366-4.14851.57862-11.25229.52696-14.85996-.10807zM117.9586 163.14859c7.66738-1.41157 14.24402-3.97835 21.89691-8.5461l3.72858-2.22546v-12.58107c0-11.74762-.0314-12.59038-.47455-12.72168-1.42309-.42168-10.77757-1.80215-14.1221-2.08405-4.68265-.39467-14.28993-.18758-17.80807.38387-8.70887 1.41459-13.028171 3.55254-15.811026 7.82606-2.230704 3.42561-3.30745 7.4555-3.304504 12.36763.0032 5.38208 1.685615 10.33001 4.555689 13.39835 1.872987 2.00238 6.082191 3.96008 9.779001 4.54822 2.10281.33454 8.92935.11855 11.56007-.36577z" transform="scale(0.26458333)"/></svg></span></a><button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/aws-controllers-k8s/community><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav flex-grow-1 main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://aws-controllers-k8s.github.io/community/docs/community/overview/>Documentation</a></li><li class=nav-item><a class=nav-link href=https://aws-controllers-k8s.github.io/community/reference/>API Reference</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-introduction aria-expanded=false>
Introduction</button><div class="collapse collapsed" id=section-introduction><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/overview/>Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/how-it-works/>How it Works</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/services/>Services</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/releases/>Release Phases</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-getting-started aria-expanded=false>
Getting Started</button><div class="collapse collapsed" id=section-getting-started><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/install/>Install an ACK Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/irsa/>Configure IAM Permissions</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/resource-crud/>Create an ACK Resource</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/multi-region-resource-management/>Manage Resources In Multiple Regions</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/cross-account-resource-management/>Manage Resources In Multiple AWS Accounts</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/drift-recovery/>Recovering from Drift</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/leader-election/>Managing multiple instances of ACK with leader election</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/authorization/>Permissions Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/authentication/>Authentication and Credentials</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/field-export/>Copy a resource field into a ConfigMap or Secret</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/adopted-resource/>Adopting Existing AWS Resources</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/ack-tags/>Managing Tags on your AWS Resources</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/deletion-policy/>Retain AWS Resources after CR Deletion</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/openshift/>Red Hat OpenShift</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/cleanup/>Uninstall an ACK Controller</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded" data-bs-toggle=collapse data-bs-target=#section-tutorials aria-expanded=true>
Tutorials</button><div class="collapse show" id=section-tutorials><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/sagemaker-example/>Machine Learning with the ACK SageMaker Controller</a></li><li><a class="docs-link rounded active" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/>Scale SageMaker Workloads with Application Auto Scaling</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/rds-example/>Deploy PostgreSQL, MySQL, MariaDB Instances Using the ACK RDS Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/ec2-example/>Manage a VPC Workflow with the ACK EC2-Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/apigatewayv2-reference-example/>Manage HTTP APIs with the ACK APIGatewayv2 Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/>Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/aurora-serverless-v2/>Manage an Aurora Serverless v2 cluster with the ACK RDS Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/eventbridge-example/>Manage EventBridge event buses and rules with the ACK EventBridge Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/pipes-example/>Manage EventBridge Pipes with the ACK Pipes Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/sqs-example/>Manage SQS queues with the ACK SQS Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/lambda-oci-example/>Create a Lambda OCI Function with the ACK Lambda Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/emr-on-eks-example/>Run Spark jobs using the ACK EMR on EKS controller</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-contributor aria-expanded=false>
Contributor Docs</button><div class="collapse collapsed" id=section-contributor><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/overview/>Contribution Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/tenets/>Project Tenets</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/code-generation/>Code Generation</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/code-organization/>Code Organization</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/operatorhub-onboarding/>OperatorHub Onboarding</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/api-inference/>API Inference</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/setup/>Setup</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/building-controller/>Building a Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/code-generator-config/>Understanding generator.yaml configuration</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/>Testing</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/release/>Release</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-discussion aria-expanded=false>
Discussion</button><div class="collapse collapsed" id=section-discussion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/background/>Background</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/faq/>FAQ</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/discussions/>Discussions</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><hr><span class=small><nav id=TableOfContents><ul><li><a href=#setup>Setup</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#configure-iam-permissions>Configure IAM permissions</a></li><li><a href=#install-the-application-auto-scaling-ack-service-controller>Install the Application Auto Scaling ACK service controller</a></li><li><a href=#prepare-your-pretrained-model>Prepare your pretrained model</a></li><li><a href=#configure-permissions-for-your-sagemaker-endpoint>Configure permissions for your SageMaker endpoint</a></li></ul></li><li><a href=#deploy-a-sagemaker-endpoint>Deploy a SageMaker endpoint</a></li><li><a href=#automatically-scale-your-sagemaker-endpoint>Automatically scale your SageMaker endpoint</a><ul><li><a href=#create-a-scalable-target>Create a scalable target</a></li><li><a href=#create-a-scaling-policy>Create a scaling policy</a></li></ul></li><li><a href=#next-steps>Next steps</a><ul><li><a href=#updates>Updates</a></li><li><a href=#cleanup>Cleanup</a></li></ul></li></ul></nav></span></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Scale SageMaker Workloads with Application Auto Scaling</h1><p class=lead>Scale a SageMaker endpoint with the ACK Application Auto Scaling service controller</p><p>The Application Auto Scaling ACK service controller makes it easier for developers to automatically scale resources for individual AWS services. Application Auto Scaling allows you to configure automatic scaling for resources such as Amazon SageMaker endpoint variants.</p><p>In this tutorial, we will use the Application Auto Scaling ACK service controller in conjunction with the SageMaker ACK service controller to automatically scale a deployed machine learning model.</p><h2 id=setup>Setup<a href=#setup class=anchor aria-hidden=true>#</a></h2><p>Although it is not necessary to use Amazon Elastic Kubernetes Service (Amazon EKS) with ACK, this guide assumes that you have access to an Amazon EKS cluster. If this is your first time creating an Amazon EKS cluster, see <a href=https://docs.aws.amazon.com/deep-learning-containers/latest/devguide/deep-learning-containers-eks-setup.html>Amazon EKS Setup</a>. For automated cluster creation using <code>eksctl</code>, see <a href=https://docs.aws.amazon.com/eks/latest/userguide/getting-started-eksctl.html>Getting started with Amazon EKS - <code>eksctl</code></a> and create your cluster with Amazon EC2 Linux managed nodes.</p><p>This guide also assumes that you have a trained machine learning model that you are ready to dynamically scale with the Application Auto Scaling ACK service controller. To train a machine learning model using the SageMaker ACK service controller, see <a href=../sagemaker-example/>Machine Learning with the ACK Service Controller</a> and return to this guide when you have successfully completed a SageMaker training job.</p><h3 id=prerequisites>Prerequisites<a href=#prerequisites class=anchor aria-hidden=true>#</a></h3><p>This guide assumes that you have:</p><ul><li>Created an EKS cluster with Kubernetes version 1.16 or higher.</li><li>AWS IAM permissions to create roles and attach policies to roles.</li><li>A trained machine learning model that you want to scale dynamically.</li><li>Installed the following tools on the client machine used to access your Kubernetes cluster:<ul><li><a href=https://docs.aws.amazon.com/cli/latest/userguide/install-cliv1.html>AWS CLI</a> - A command line tool for interacting with AWS services.</li><li><a href=https://docs.aws.amazon.com/eks/latest/userguide/install-kubectl.html>kubectl</a> - A command line tool for working with Kubernetes clusters.</li><li><a href=https://docs.aws.amazon.com/eks/latest/userguide/eksctl.html>eksctl</a> - A command line tool for working with EKS clusters.</li><li><a href=https://mikefarah.gitbook.io/yq>yq</a> - A command line tool for YAML processing. (For Linux environments, use the <a href=https://mikefarah.gitbook.io/yq/#wget><code>wget</code> plain binary installation</a>)</li><li><a href=https://helm.sh/docs/intro/install/>Helm 3.7+</a> - A tool for installing and managing Kubernetes applications.</li><li><a href=https://everything.curl.dev/get>curl</a> - A command line tool for transmitting data with URLs.</li></ul></li></ul><h3 id=configure-iam-permissions>Configure IAM permissions<a href=#configure-iam-permissions class=anchor aria-hidden=true>#</a></h3><p>Create an IAM role and attach an IAM policy to that role to ensure that your Application Auto Scaling service controller has access to the appropriate AWS resources. First, check to make sure that you are connected to an Amazon EKS cluster.</p><pre><code class=language-bash>export CLUSTER_NAME=&lt;CLUSTER_NAME&gt;
export SERVICE_REGION=&lt;CLUSTER_REGION&gt;
aws eks update-kubeconfig --name $CLUSTER_NAME --region $SERVICE_REGION
kubectl config current-context
kubectl get nodes
</code></pre><p>Before you can deploy your ACK service controllers using an IAM role, associate an OpenID Connect (OIDC) provider with your IAM role to authenticate your cluster with the IAM service.</p><pre><code class=language-bash>eksctl utils associate-iam-oidc-provider --cluster ${CLUSTER_NAME} \
--region ${SERVICE_REGION} --approve
</code></pre><p>Get the following OIDC information for future reference:</p><pre><code class=language-bash>export AWS_ACCOUNT_ID=$(aws sts get-caller-identity --query &quot;Account&quot; --output text)
export OIDC_PROVIDER_URL=$(aws eks describe-cluster --name $CLUSTER_NAME --region $SERVICE_REGION \
--query &quot;cluster.identity.oidc.issuer&quot; --output text | cut -c9-)
</code></pre><p>In your working directory, create a file named <code>trust.json</code> using the following trust relationship code block:</p><pre><code class=language-bash>printf '{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Principal&quot;: {
        &quot;Federated&quot;: &quot;arn:aws:iam::'$AWS_ACCOUNT_ID':oidc-provider/'$OIDC_PROVIDER_URL'&quot;
      },
      &quot;Action&quot;: &quot;sts:AssumeRoleWithWebIdentity&quot;,
      &quot;Condition&quot;: {
        &quot;StringEquals&quot;: {
          &quot;'$OIDC_PROVIDER_URL':aud&quot;: &quot;sts.amazonaws.com&quot;,
          &quot;'$OIDC_PROVIDER_URL':sub&quot;: [
            &quot;system:serviceaccount:ack-system:ack-sagemaker-controller&quot;,
            &quot;system:serviceaccount:ack-system:ack-applicationautoscaling-controller&quot;
          ]
        }
      }
    }
  ]
}
' &gt; ./trust.json
</code></pre><p>Updating an Application Auto Scaling Scalable Target requires additional permissions. First, create a service-linked role for Application Auto Scaling.</p><pre><code class=language-sh> aws iam create-service-linked-role --aws-service-name sagemaker.application-autoscaling.amazonaws.com
</code></pre><p>Create a file named <code>pass_role_policy.json</code> to create the policy required for the IAM role.</p><pre><code class=language-bash>printf '{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: &quot;iam:PassRole&quot;,
      &quot;Resource&quot;: &quot;arn:aws:iam::'$AWS_ACCOUNT_ID':role/aws-service-role/sagemaker.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_SageMakerEndpoint&quot;
    }
  ]
}
' &gt; ./pass_role_policy.json
</code></pre><p>Run the <code>iam create-role</code> command to create an IAM role with the trust relationship you just defined in <code>trust.json</code>. This IAM role enables the Amazon EKS cluster to get and refresh credentials from IAM.</p><pre><code class=language-bash>export OIDC_ROLE_NAME=ack-controller-role-$CLUSTER_NAME
aws --region $SERVICE_REGION iam create-role --role-name $OIDC_ROLE_NAME --assume-role-policy-document file://trust.json
</code></pre><p>Attach the AmazonSageMakerFullAccess Policy to the IAM Role to ensure that your SageMaker service controller has access to the appropriate resources.</p><pre><code class=language-bash>aws --region $SERVICE_REGION iam attach-role-policy --role-name $OIDC_ROLE_NAME --policy-arn arn:aws:iam::aws:policy/AmazonSageMakerFullAccess
</code></pre><p>Attach the <code>iam:PassRole</code> policy required for updating an Application Auto Scaling Scalable Target.</p><pre><code class=language-bash>aws iam put-role-policy --role-name $OIDC_ROLE_NAME --policy-name &quot;iam-pass-role-policy&quot; --policy-document file://pass_role_policy.json
</code></pre><p>Get the following IAM role information for future reference:</p><pre><code class=language-bash>export IAM_ROLE_ARN_FOR_IRSA=$(aws --region $SERVICE_REGION iam get-role --role-name $OIDC_ROLE_NAME --output text --query 'Role.Arn')
echo $IAM_ROLE_ARN_FOR_IRSA
</code></pre><p>For more information on authorization and access for ACK service controllers, including details regarding recommended IAM policies, see <a href=../../user-docs/authorization/>Configure Permissions</a>.</p><h3 id=install-the-application-auto-scaling-ack-service-controller>Install the Application Auto Scaling ACK service controller<a href=#install-the-application-auto-scaling-ack-service-controller class=anchor aria-hidden=true>#</a></h3><p>Get the Application Auto Scaling Helm chart and make it available on the client machine with the following commands:</p><pre><code class=language-bash>export HELM_EXPERIMENTAL_OCI=1
export SERVICE=applicationautoscaling
export RELEASE_VERSION=$(curl -sL https://api.github.com/repos/aws-controllers-k8s/${SERVICE}-controller/releases/latest | jq -r '.tag_name | ltrimstr(&quot;v&quot;)')

if [[ -z &quot;$RELEASE_VERSION&quot; ]]; then
  RELEASE_VERSION=1.0.2
fi  

export CHART_EXPORT_PATH=/tmp/chart
export CHART_REF=$SERVICE-chart
export CHART_REPO=public.ecr.aws/aws-controllers-k8s/$CHART_REF
export CHART_PACKAGE=$CHART_REF-$RELEASE_VERSION.tgz

mkdir -p $CHART_EXPORT_PATH

helm pull oci://$CHART_REPO --version $RELEASE_VERSION -d $CHART_EXPORT_PATH
tar xvf $CHART_EXPORT_PATH/$CHART_PACKAGE -C $CHART_EXPORT_PATH
</code></pre><p>Update the Helm chart values for a cluster-scoped installation.</p><pre><code class=language-bash># Update the following values in the Helm chart
cd $CHART_EXPORT_PATH/$SERVICE-chart
yq e '.aws.region = env(SERVICE_REGION)' -i values.yaml
yq e '.serviceAccount.annotations.&quot;eks.amazonaws.com/role-arn&quot; = env(IAM_ROLE_ARN_FOR_IRSA)' -i values.yaml
cd -
</code></pre><p>Install the relevant custom resource definitions (CRDs) for the Application Auto Scaling ACK service controller.</p><pre><code class=language-bash>kubectl apply -f $CHART_EXPORT_PATH/$SERVICE-chart/crds
</code></pre><p>Create a namespace and install the Application Auto Scaling ACK service controller with the Helm chart.</p><pre><code class=language-bash>export ACK_K8S_NAMESPACE=ack-system
helm install -n $ACK_K8S_NAMESPACE --create-namespace --skip-crds ack-$SERVICE-controller \
 $CHART_EXPORT_PATH/$SERVICE-chart
</code></pre><p>Verify that the CRDs and Helm charts were deployed with the following commands:</p><pre><code class=language-bash>kubectl get pods -A | grep applicationautoscaling
kubectl get crd | grep applicationautoscaling
</code></pre><p>To scale a SageMaker endpoint variant with the Application Auto Scaling ACK service controller, you will also need the SageMaker ACK service controller. For step-by-step installation instructions see <a href=../sagemaker-example/#install-the-sagemaker-ack-service-controller>Install the SageMaker ACK Service Controller</a>.</p><h3 id=prepare-your-pretrained-model>Prepare your pretrained model<a href=#prepare-your-pretrained-model class=anchor aria-hidden=true>#</a></h3><p>To scale a SageMaker endpoint with Application Auto Scaling, we first need a pretrained model in an S3 bucket. For this example, we will be using a pretrained XGBoost model.</p><p>First, create a variable for the S3 bucket:</p><pre><code class=language-bash>export ACCOUNT_ID=$(aws sts get-caller-identity --query &quot;Account&quot; --output text)
export SAGEMAKER_BUCKET=ack-sagemaker-bucket-$ACCOUNT_ID
</code></pre><p>Then, create a file named <code>create-bucket.sh</code> with the following code block:</p><pre><code class=language-bash>printf '
#!/usr/bin/env bash
# Create the S3 bucket
if [[ $SERVICE_REGION != &quot;us-east-1&quot; ]]; then
  aws s3api create-bucket --bucket &quot;$SAGEMAKER_BUCKET&quot; --region &quot;$SERVICE_REGION&quot; --create-bucket-configuration LocationConstraint=&quot;$SERVICE_REGION&quot;
else
  aws s3api create-bucket --bucket &quot;$SAGEMAKER_BUCKET&quot; --region &quot;$SERVICE_REGION&quot;
fi' &gt; ./create-bucket.sh
</code></pre><p>Run the <code>create-bucket.sh</code> script to create an S3 bucket.</p><pre><code class=language-bash>chmod +x create-bucket.sh
./create-bucket.sh
</code></pre><p>Get the pretrained model and copy it into your S3 bucket.</p><pre><code class=language-bash>wget https://github.com/aws/amazon-sagemaker-examples/raw/af6667bd0be3c9cdec23fecda7f0be6d0e3fa3ea/sagemaker_model_monitor/introduction/model/xgb-churn-prediction-model.tar.gz
aws s3 cp xgb-churn-prediction-model.tar.gz s3://$SAGEMAKER_BUCKET
</code></pre><h3 id=configure-permissions-for-your-sagemaker-endpoint>Configure permissions for your SageMaker endpoint<a href=#configure-permissions-for-your-sagemaker-endpoint class=anchor aria-hidden=true>#</a></h3><p>The SageMaker endpoint that we deploy will need an IAM role to access Amazon S3 and Amazon SageMaker. Run the following commands to create a SageMaker execution IAM role that will be used by SageMaker to access the appropriate AWS resources:</p><pre><code class=language-bash>export SAGEMAKER_EXECUTION_ROLE_NAME=ack-sagemaker-execution-role-$ACCOUNT_ID

TRUST=&quot;{ \&quot;Version\&quot;: \&quot;2012-10-17\&quot;, \&quot;Statement\&quot;: [ { \&quot;Effect\&quot;: \&quot;Allow\&quot;, \&quot;Principal\&quot;: { \&quot;Service\&quot;: \&quot;sagemaker.amazonaws.com\&quot; }, \&quot;Action\&quot;: \&quot;sts:AssumeRole\&quot; } ] }&quot;
aws iam create-role --role-name ${SAGEMAKER_EXECUTION_ROLE_NAME} --assume-role-policy-document &quot;$TRUST&quot;
aws iam attach-role-policy --role-name ${SAGEMAKER_EXECUTION_ROLE_NAME} --policy-arn arn:aws:iam::aws:policy/AmazonSageMakerFullAccess
aws iam attach-role-policy --role-name ${SAGEMAKER_EXECUTION_ROLE_NAME} --policy-arn arn:aws:iam::aws:policy/AmazonS3FullAccess

SAGEMAKER_EXECUTION_ROLE_ARN=$(aws iam get-role --role-name ${SAGEMAKER_EXECUTION_ROLE_NAME} --output text --query 'Role.Arn')

echo $SAGEMAKER_EXECUTION_ROLE_ARN
</code></pre><h2 id=deploy-a-sagemaker-endpoint>Deploy a SageMaker endpoint<a href=#deploy-a-sagemaker-endpoint class=anchor aria-hidden=true>#</a></h2><p>Use the SageMaker ACK service controller to create a model, an endpoint configuration, and an endpoint.</p><pre><code class=language-bash>export RANDOM_VAR=$RANDOM
export MODEL_NAME=ack-xgboost-model-$RANDOM_VAR
export ENDPOINT_CONFIG_NAME=ack-xgboost-endpoint-config-$RANDOM_VAR
export ENDPOINT_NAME=ack-xgboost-endpoint-$RANDOM_VAR
export XGBOOST_IMAGE=683313688378.dkr.ecr.us-east-1.amazonaws.com/sagemaker-xgboost:1.2-1
</code></pre><div class="hint d-flex flex-column border-start my-4 border-4 hint-info"><div class="hint-title p-2 flex flex-row flex-items-center">Change XGBoost image URI based on region</div><div class="hint-body p-2 small"><strong>IMPORTANT</strong>: If your <code>SERVICE_REGION</code> is not <code>us-east-1</code>, you must change the <code>XGBOOST_IMAGE</code> URI. To find your region-specific XGBoost image URI, choose your region in the <a href=https://docs.aws.amazon.com/sagemaker/latest/dg/sagemaker-algo-docker-registry-paths.html>SageMaker Docker Registry Paths page</a>, and then select <strong>XGBoost (algorithm)</strong>. For this example, use version 1.2-1.</div></div><p>Use the following <code>deploy.yaml</code> file to deploy the model on an <code>ml.m5.large</code> instance. To use your own model, change the <code>modelDataURL</code> value.</p><pre><code class=language-bash>printf '
apiVersion: sagemaker.services.k8s.aws/v1alpha1
kind: Model
metadata:
  name: '$MODEL_NAME'
spec:
  modelName: '$MODEL_NAME'
  primaryContainer:
    containerHostname: xgboost
    # The source of the model data
    modelDataURL: s3://'$SAGEMAKER_BUCKET'/xgb-churn-prediction-model.tar.gz
    image: '$XGBOOST_IMAGE'
  executionRoleARN: '$SAGEMAKER_EXECUTION_ROLE_ARN'
---
apiVersion: sagemaker.services.k8s.aws/v1alpha1
kind: EndpointConfig
metadata:
  name: '$ENDPOINT_CONFIG_NAME'
spec:
  endpointConfigName: '$ENDPOINT_CONFIG_NAME'
  productionVariants:
  - modelName: '$MODEL_NAME'
    variantName: AllTraffic
    instanceType: ml.m5.large
    initialInstanceCount: 1
---
apiVersion: sagemaker.services.k8s.aws/v1alpha1
kind: Endpoint
metadata:
  name: '$ENDPOINT_NAME'
spec:
  endpointName: '$ENDPOINT_NAME'
  endpointConfigName: '$ENDPOINT_CONFIG_NAME'
' &gt; ./deploy.yaml
</code></pre><p>Deploy the endpoint by applying the <code>deploy.yaml</code> file.</p><pre><code class=language-bash>kubectl apply -f deploy.yaml
</code></pre><p>After applying the <code>deploy.yaml</code> file, you should see that the model, endpoint configuration, and endpoint were successfully created.</p><pre><code class=language-bash>model.sagemaker.services.k8s.aws/ack-xgboost-model-7420 created
endpointconfig.sagemaker.services.k8s.aws/ack-xgboost-endpoint-config-7420 created
endpoint.sagemaker.services.k8s.aws/ack-xgboost-endpoint-7420 created
</code></pre><p>Watch the process with the <code>kubectl get</code> command. Deploying the endpoint may take some time.</p><pre><code class=language-bash>kubectl get endpoints.sagemaker --watch
</code></pre><p>The endpoint status will be <code>InService</code> when the endpoint is successfully deployed and ready for use.</p><pre><code class=language-bash>NAME                        ENDPOINTSTATUS
ack-xgboost-endpoint-7420   Creating         
ack-xgboost-endpoint-7420   InService    
</code></pre><h2 id=automatically-scale-your-sagemaker-endpoint>Automatically scale your SageMaker endpoint<a href=#automatically-scale-your-sagemaker-endpoint class=anchor aria-hidden=true>#</a></h2><p>Scale your SageMaker endpoint using the Application Auto Scaling <a href=https://aws-controllers-k8s.github.io/community/reference/applicationautoscaling/v1alpha1/scalabletarget/><code>ScalableTarget</code></a> and <a href=https://aws-controllers-k8s.github.io/community/reference/applicationautoscaling/v1alpha1/scalingpolicy/><code>ScalingPolicy</code></a> resources.</p><h3 id=create-a-scalable-target>Create a scalable target<a href=#create-a-scalable-target class=anchor aria-hidden=true>#</a></h3><p>Create a scalable target with the <code>scalable-target.yaml</code> file. The following file designates that a specified SageMaker endpoint variant can automatically scale to up to three instances.</p><pre><code class=language-bash>printf '
apiVersion: applicationautoscaling.services.k8s.aws/v1alpha1
kind: ScalableTarget
metadata:
  name: ack-tutorial-endpoint-scalable-target
spec:
  maxCapacity: 3
  minCapacity: 1
  resourceID: endpoint/'$ENDPOINT_NAME'/variant/AllTraffic
  scalableDimension: &quot;sagemaker:variant:DesiredInstanceCount&quot;
  serviceNamespace: sagemaker
 ' &gt; ./scalable-target.yaml
</code></pre><p>Apply your <code>scalable-target.yaml</code> file:</p><pre><code class=language-bash>kubectl apply -f scalable-target.yaml
</code></pre><p>After applying your scalable target, you should see the following output:</p><pre><code class=language-bash>scalabletarget.applicationautoscaling.services.k8s.aws/ack-tutorial-endpoint-scalable-target created
</code></pre><p>You can verify that the <code>ScalableTarget</code> was created with the <code>kubectl describe</code> command.</p><pre><code class=language-bash>kubectl describe scalabletarget.applicationautoscaling
</code></pre><h3 id=create-a-scaling-policy>Create a scaling policy<a href=#create-a-scaling-policy class=anchor aria-hidden=true>#</a></h3><p>Create a scaling policy with the <code>scaling-policy.yaml</code> file. The following file creates a target tracking scaling policy that scales a specified SageMaker endpoint based on the number of variant invocations per instance. The scaling policy adds or removes capacity as required to keep this number close to the target value of 60.</p><pre><code class=language-bash>printf '
apiVersion: applicationautoscaling.services.k8s.aws/v1alpha1
kind: ScalingPolicy
metadata:
  name: ack-tutorial-endpoint-scaling-policy
spec:
  policyName: ack-tutorial-endpoint-scaling-policy
  policyType: TargetTrackingScaling
  resourceID: endpoint/'$ENDPOINT_NAME'/variant/AllTraffic
  scalableDimension: &quot;sagemaker:variant:DesiredInstanceCount&quot;
  serviceNamespace: sagemaker
  targetTrackingScalingPolicyConfiguration:
    targetValue: 60
    scaleInCooldown: 700
    scaleOutCooldown: 300
    predefinedMetricSpecification:
        predefinedMetricType: SageMakerVariantInvocationsPerInstance
 ' &gt; ./scaling-policy.yaml
</code></pre><p>Apply your <code>scaling-policy.yaml</code> file:</p><pre><code class=language-bash>kubectl apply -f scaling-policy.yaml
</code></pre><p>After applying your scaling policy, you should see the following output:</p><pre><code class=language-bash>scalingpolicy.applicationautoscaling.services.k8s.aws/ack-tutorial-endpoint-scaling-policy created
</code></pre><p>You can verify that the <code>ScalingPolicy</code> was created with the <code>kubectl describe</code> command.</p><pre><code class=language-bash>kubectl describe scalingpolicy.applicationautoscaling
</code></pre><h2 id=next-steps>Next steps<a href=#next-steps class=anchor aria-hidden=true>#</a></h2><p>To learn more about Application Auto Scaling on a SageMaker endpoint, see the <a href=https://github.com/aws-controllers-k8s/applicationautoscaling-controller/tree/main/samples/hosting-autoscaling-on-sagemaker>Application Auto Scaling controller samples</a> repository.</p><h3 id=updates>Updates<a href=#updates class=anchor aria-hidden=true>#</a></h3><p>To update the <code>ScalableTarget</code> and <code>ScalingPolicy</code> parameters after the resources are created, make any changes to the <code>scalable-target.yaml</code> or <code>scaling-policy.yaml</code> files and reapply them with <code>kubectl apply</code>.</p><pre><code class=language-bash>kubectl apply -f scalable-target.yaml
kubectl apply -f scaling-policy.yaml.yaml
</code></pre><h3 id=cleanup>Cleanup<a href=#cleanup class=anchor aria-hidden=true>#</a></h3><p>You can delete your training jobs, endpoints, scalable targets, and scaling policies with the <code>kubectl delete</code> command.</p><pre><code class=language-bash>kubectl delete -f deploy.yaml
kubectl delete -f scalable-target.yaml
kubectl delete -f scaling-policy.yaml
</code></pre><p>To remove the SageMaker and Application Auto Scaling ACK service controllers, related CRDs, and namespaces see <a href=../../user-docs/cleanup/>ACK Cleanup</a>.</p><p>It is recommended to delete any additional resources such as S3 buckets, IAM roles, and IAM policies when you no longer need them. You can delete these resources with the following commands or directly in the AWS console.</p><pre><code class=language-bash># Delete S3 bucket
aws s3 rb s3://$SAGEMAKER_BUCKET --force

# Delete SageMaker execution role
aws iam detach-role-policy --role-name $SAGEMAKER_EXECUTION_ROLE_NAME --policy-arn arn:aws:iam::aws:policy/AmazonSageMakerFullAccess
aws iam detach-role-policy --role-name $SAGEMAKER_EXECUTION_ROLE_NAME --policy-arn arn:aws:iam::aws:policy/AmazonS3FullAccess
aws iam delete-role --role-name $SAGEMAKER_EXECUTION_ROLE_NAME

# Delete IAM role created for IRSA
aws iam detach-role-policy --role-name $OIDC_ROLE_NAME --policy-arn arn:aws:iam::aws:policy/AmazonSageMakerFullAccess
aws iam delete-role --role-name $OIDC_ROLE_NAME
</code></pre><p>To delete your EKS clusters, see <a href=https://docs.aws.amazon.com/eks/latest/userguide/delete-cluster.html>Amazon EKS - Deleting a cluster</a>.</p><p class=edit-page><a href=https://github.com/aws-controllers-k8s/community/blob/main/docs/content/docs/tutorials/autoscaling-example.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class=my-n3></div></main></div></div></div><footer class="footer mt-auto text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://aws-controllers-k8s.github.io/community/js/bootstrap.min.b215b4cd9b395d6674fe820a7dfe831d833cf64feef865325eb6e3256a4cf84110a040b38af60cdecabe307668c218a83a96ff6f1aa1dade51fc78195449e610.js integrity="sha512-shW0zZs5XWZ0/oIKff6DHYM89k/u+GUyXrbjJWpM+EEQoECzivYM3sq+MHZowhioOpb/bxqh2t5R/HgZVEnmEA==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/js/highlight.min.845ac7a35070c98e709cb2c243868ea6535713a4e36512571d6995b58dc2e9710dc129f61e35d985044dea835379d832388bc7449de083d2d1e208bf015920fc.js integrity="sha512-hFrHo1BwyY5wnLLCQ4aOplNXE6TjZRJXHWmVtY3C6XENwSn2HjXZhQRN6oNTedgyOIvHRJ3gg9LR4gi/AVkg/A==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/main.min.f2b231c301bb6bb703581a2ab160f506b26c9b58a8321a04bff902e06cf229ac0c6d21eeb75cab5a14e5d6f4dd54753134874d6cab025313d1c9b6e8dbe649b5.js integrity="sha512-8rIxwwG7a7cDWBoqsWD1BrJsm1ioMhoEv/kC4GzyKawMbSHut1yrWhTl1vTdVHUxNIdNbKsCUxPRybbo2+ZJtQ==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/index.min.aeda70747944c6d0a016ba6563a30a12350fd45dd587d07a7a31649c5570d8c102e59dbcff399ad7b377633c4e600019acbdc4204bacb7877bff85d2382297bc.js integrity="sha512-rtpwdHlExtCgFrplY6MKEjUP1F3Vh9B6ejFknFVw2MEC5Z28/zma17N3YzxOYAAZrL3EIEust4d7/4XSOCKXvA==" crossorigin=anonymous defer></script></body></html>