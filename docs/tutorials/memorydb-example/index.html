<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300..800&display=swap" rel=stylesheet><link rel=stylesheet href=https://aws-controllers-k8s.github.io/community/main.f517faa096c24320af682654b45d20aca5c6d4332b60ebc9db1ca399e299e0d52dfa1199156fb43e599f609b4d13a2710f0c119f2ad9526953677fe88994dbc4.css integrity="sha512-9Rf6oJbCQyCvaCZUtF0grKXG1DMrYOvJ2xyjmeKZ4NUt+hGZFW+0PlmfYJtNE6JxDwwRnyrZUmlTZ3/oiZTbxA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller - ACK</title><meta name=description content="Create a managed Amazon MemoryDB for Redis Cluster using the memorydb-controller"><link rel=canonical href=https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller"><meta property="og:description" content="Create a managed Amazon MemoryDB for Redis Cluster using the memorydb-controller"><meta property="og:url" content="https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/"><meta property="og:site_name" content="ACK"><meta property="og:image" content="https://aws-controllers-k8s.github.io/community/og.png"><meta property="og:image:alt" content="ACK"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@awscloud"><meta name=twitter:creator content><meta name=twitter:title content="Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller"><meta name=twitter:description content="Create a managed Amazon MemoryDB for Redis Cluster using the memorydb-controller"><meta name=twitter:image content="https://aws-controllers-k8s.github.io/community/og.png"><meta name=twitter:image:alt content="Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1","name":"AWS Controllers for K8s","url":"https://aws-controllers-k8s.github.io/","sameAs":["https://twitter.com/awscloud","https://github.com/aws-controllers-k8s/community"],"logo":{"@type":"ImageObject","@id":"https://aws-controllers-k8s.github.io/#/schema/image/1","url":"https://aws-controllers-k8s.github.io/ack.png","width":512,"height":512,"caption":"AWS Controllers for K8s"},"image":{"@id":"https://aws-controllers-k8s.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://aws-controllers-k8s.github.io/#/schema/website/1","url":"https://aws-controllers-k8s.github.io/","name":"ACK","description":"Doks is a Hugo theme helping you build modern documentation websites that are secure, fast, and SEO-ready — by default.","publisher":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/","url":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/","name":"Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller","description":"Create a managed Amazon MemoryDB for Redis Cluster using the memorydb-controller","isPartOf":{"@id":"https://aws-controllers-k8s.github.io/#/schema/website/1"},"about":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/"]}]},{"@type":"BreadcrumbList","@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/","url":"https://aws-controllers-k8s.github.io/community/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/","url":"https://aws-controllers-k8s.github.io/community/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/","url":"https://aws-controllers-k8s.github.io/community/docs/tutorials/","name":"Tutorials"}},{"@type":"ListItem","position":4,"item":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://aws-controllers-k8s.github.io/#/schema/article/1","headline":"Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller","description":"Create a managed Amazon MemoryDB for Redis Cluster using the memorydb-controller","isPartOf":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/"},"mainEntityOfPage":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","author":{"@id":"https://aws-controllers-k8s.github.io/#/schema/person/2"},"publisher":{"@id":"https://aws-controllers-k8s.github.io/#/schema/organization/1"},"image":{"@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://aws-controllers-k8s.github.io/#/schema/person/2","name":"AWS","sameAs":["https://twitter.com/awscloud","https://github.com/aws-controllers-k8s"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/#/schema/image/2","url":"https://aws-controllers-k8s.github.io/community/og.png","contentUrl":"https://aws-controllers-k8s.github.io/community/og.png","caption":"Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller"}]}]}</script><meta name=theme-color content="#ff9900"><link rel=apple-touch-icon sizes=180x180 href=https://aws-controllers-k8s.github.io/community/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://aws-controllers-k8s.github.io/community/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://aws-controllers-k8s.github.io/community/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://aws-controllers-k8s.github.io/community/site.webmanifest><link rel=mask-icon color=#5bbad5 href=https://aws-controllers-k8s.github.io/community/safari-pinned-tab.svg><meta name=msapplication-TileColor content="#da532c"><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body class="docs single d-flex flex-column h-100 dark"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" href=https://aws-controllers-k8s.github.io/community/><span class="navbar-logo logo-light"><svg width="30" height="34" viewBox="0 0 64.386 62.635" xmlns="http://www.w3.org/2000/svg"><path d="m18.112 62.241c-.58208-.2097-1.0825-.38307-1.1121-.38526-.05964-.004-6.9703-8.5523-8.016-9.9151-.3638-.47411-1.8521-2.3244-3.3073-4.1118-6.169-7.5771-5.7671-6.894-5.6043-9.525.07652-1.2369.2681-2.6062.42574-3.0427.15763-.43656.88408-3.4726 1.6143-6.7469s1.4423-6.4294 1.5822-7.0115c.13998-.58209.49521-2.1299.78941-3.4396 1.3414-5.9718 1.3876-6.0514 4.3737-7.5406 1.313-.65484 3.9324-1.927 5.8208-2.8269 1.8885-.89995 6.3475-3.0258 9.9091-4.7242 7.7798-3.7099 7.4615-3.6736 12.178-1.3871 1.6735.81137 4.531 2.1853 6.35 3.0532 1.819.86788 4.4384 2.1189 5.8208 2.78 1.3824.66112 3.7644 1.7868 5.2931 2.5015 2.9983 1.4017 4.0296 2.3189 4.4852 3.9889.24392.89408.61395 2.4653 2.1314 9.0501.28504 1.2369.86914 3.7372 1.298 5.5562s.97374 4.2003 1.2108 5.2917c.2371 1.0914.56563 2.4425.73006 3.0024.50213 1.7098.37232 3.363-.34938 4.4494-.35422.53325-2.549 3.3137-4.8774 6.1788-2.3283 2.8651-4.531 5.6016-4.8948 6.0813-3.5052 4.6213-6.5923 8.1362-7.558 8.6052-1.0278.49922-1.6581.52197-14.155.51087-10.7-.01-13.272-.081-14.138-.39289zm14.42-14.853c1.993-.65861 4.1321-1.8055 5.208-2.7923l.57777-.52995.15829 1.0218c.37804 2.4404.25325 2.3447 3.0582 2.3447h2.5072v-12.965c0-14.742.01357-14.637-2.1954-17.096-2.2207-2.4725-5.3026-3.3183-11.157-3.0616-3.7392.16395-6.9101.77913-9.2875 1.8019l-1.3054.56157v2.2164c0 1.219.0817 2.2164.18156 2.2164s1.0226-.23473 2.0505-.52163c2.4182-.67492 6.8343-1.3304 8.9629-1.3304 2.0099.0 4.3168.63112 5.1681 1.4139 1.22 1.1218 1.459 1.9649 1.5795 5.5722.10844 3.2453.08971 3.4049-.37858 3.2252-.27096-.10398-1.6251-.35976-3.0091-.56841-6.4942-.979-10.999.005-14.067 3.0735-2.0011 2.0011-2.4548 3.2402-2.4641 6.7305-.0065 2.4258.08634 3.1141.55768 4.1334 1.179 2.5499 3.2925 4.2534 5.9416 4.9794 2.3169.63499 5.0434.52227 7.9127-.42589zm-5.3603-4.4174c-1.3419-.50246-1.7811-.90498-2.3487-2.1529-.96238-2.1156-.37837-5.1724 1.2299-6.4375 1.6643-1.3091 6.0181-1.7402 10.183-1.0084l1.7198.30217v6.6092l-1.4496.86623c-3.1522 1.8836-7.1071 2.6552-9.3347 1.8212z" stroke-width=".26458" style="fill:#212529"/><path style="fill:none;stroke-width:.271169" d="m97.026736 181.42372c-11.841729-2.08439-21.332462-9.10215-26.093859-19.29466-1.998022-4.27707-2.054194-4.6839-2.055098-14.88419-841e-6-9.49243.144169-11.16725 1.267846-14.64314 1.712817-5.29828 6.177554-10.936 12.299033-15.53024 2.542552-1.90822 7.390509-4.53026 10.594967-5.73033 8.933335-3.34556 20.674605-4.18152 34.409895-2.44995 4.41785.55695 12.65266 1.97363 14.19738 2.44244 1.76241.53489 1.85502.50959 2.22367-.60744.24279-.73566.28029-2.73516.14369-7.66053-.44788-16.149002-1.23751-19.911778-5.02917-23.965076-1.80821-1.932978-3.56225-2.973051-7.11557-4.219231-5.30124-1.859191-12.26098-2.569875-19.19872-1.960452-10.49153.921594-19.993865 2.573896-30.430988 5.291456l-5.619006 1.463045-.198978-.992725C76.31239 78.136699 76.217381 74.401849 76.210696 70.38303l-.01215-7.306943 3.356503-1.444983c10.517529-4.527823 21.216871-6.656502 37.293351-7.419665 12.51101-.593907 22.76653.582675 29.54824 3.389974 4.64166 1.921419 7.46417 3.920688 11.49419 8.14168 5.92808 6.208991 7.10885 9.292714 7.94906 20.759878.20234 2.761617.35353 19.385439.44083 48.471489l.13286 44.26837-6.87266-.008c-7.35796-.009-10.40797-.26157-11.45694-.94889-1.06894-.70039-1.56607-2.17132-2.37024-7.01314-.41845-2.51943-.81979-4.63975-.89185-4.71182-.0721-.0721-.94053.61073-1.92991 1.51732-2.61666 2.39769-6.17638 4.67392-11.10375 7.10019-7.00303 3.44832-13.15672 5.41292-19.90153 6.35366-4.14851.57862-11.25229.52696-14.85996-.10807zM117.9586 163.14859c7.66738-1.41157 14.24402-3.97835 21.89691-8.5461l3.72858-2.22546v-12.58107c0-11.74762-.0314-12.59038-.47455-12.72168-1.42309-.42168-10.77757-1.80215-14.1221-2.08405-4.68265-.39467-14.28993-.18758-17.80807.38387-8.70887 1.41459-13.028171 3.55254-15.811026 7.82606-2.230704 3.42561-3.30745 7.4555-3.304504 12.36763.0032 5.38208 1.685615 10.33001 4.555689 13.39835 1.872987 2.00238 6.082191 3.96008 9.779001 4.54822 2.10281.33454 8.92935.11855 11.56007-.36577z" transform="scale(0.26458333)"/></svg></span><span class="navbar-logo logo-dark d-none"><svg width="30" height="34" viewBox="0 0 64.386 62.635" xmlns="http://www.w3.org/2000/svg"><path d="m18.112 62.241c-.58208-.2097-1.0825-.38307-1.1121-.38526-.05964-.004-6.9703-8.5523-8.016-9.9151-.3638-.47411-1.8521-2.3244-3.3073-4.1118-6.169-7.5771-5.7671-6.894-5.6043-9.525.07652-1.2369.2681-2.6062.42574-3.0427.15763-.43656.88408-3.4726 1.6143-6.7469s1.4423-6.4294 1.5822-7.0115c.13998-.58209.49521-2.1299.78941-3.4396 1.3414-5.9718 1.3876-6.0514 4.3737-7.5406 1.313-.65484 3.9324-1.927 5.8208-2.8269 1.8885-.89995 6.3475-3.0258 9.9091-4.7242 7.7798-3.7099 7.4615-3.6736 12.178-1.3871 1.6735.81137 4.531 2.1853 6.35 3.0532 1.819.86788 4.4384 2.1189 5.8208 2.78 1.3824.66112 3.7644 1.7868 5.2931 2.5015 2.9983 1.4017 4.0296 2.3189 4.4852 3.9889.24392.89408.61395 2.4653 2.1314 9.0501.28504 1.2369.86914 3.7372 1.298 5.5562s.97374 4.2003 1.2108 5.2917c.2371 1.0914.56563 2.4425.73006 3.0024.50213 1.7098.37232 3.363-.34938 4.4494-.35422.53325-2.549 3.3137-4.8774 6.1788-2.3283 2.8651-4.531 5.6016-4.8948 6.0813-3.5052 4.6213-6.5923 8.1362-7.558 8.6052-1.0278.49922-1.6581.52197-14.155.51087-10.7-.01-13.272-.081-14.138-.39289zm14.42-14.853c1.993-.65861 4.1321-1.8055 5.208-2.7923l.57777-.52995.15829 1.0218c.37804 2.4404.25325 2.3447 3.0582 2.3447h2.5072v-12.965c0-14.742.01357-14.637-2.1954-17.096-2.2207-2.4725-5.3026-3.3183-11.157-3.0616-3.7392.16395-6.9101.77913-9.2875 1.8019l-1.3054.56157v2.2164c0 1.219.0817 2.2164.18156 2.2164s1.0226-.23473 2.0505-.52163c2.4182-.67492 6.8343-1.3304 8.9629-1.3304 2.0099.0 4.3168.63112 5.1681 1.4139 1.22 1.1218 1.459 1.9649 1.5795 5.5722.10844 3.2453.08971 3.4049-.37858 3.2252-.27096-.10398-1.6251-.35976-3.0091-.56841-6.4942-.979-10.999.005-14.067 3.0735-2.0011 2.0011-2.4548 3.2402-2.4641 6.7305-.0065 2.4258.08634 3.1141.55768 4.1334 1.179 2.5499 3.2925 4.2534 5.9416 4.9794 2.3169.63499 5.0434.52227 7.9127-.42589zm-5.3603-4.4174c-1.3419-.50246-1.7811-.90498-2.3487-2.1529-.96238-2.1156-.37837-5.1724 1.2299-6.4375 1.6643-1.3091 6.0181-1.7402 10.183-1.0084l1.7198.30217v6.6092l-1.4496.86623c-3.1522 1.8836-7.1071 2.6552-9.3347 1.8212z" stroke-width=".26458" style="fill:#fff"/><path style="fill:none;stroke-width:.271169" d="m97.026736 181.42372c-11.841729-2.08439-21.332462-9.10215-26.093859-19.29466-1.998022-4.27707-2.054194-4.6839-2.055098-14.88419-841e-6-9.49243.144169-11.16725 1.267846-14.64314 1.712817-5.29828 6.177554-10.936 12.299033-15.53024 2.542552-1.90822 7.390509-4.53026 10.594967-5.73033 8.933335-3.34556 20.674605-4.18152 34.409895-2.44995 4.41785.55695 12.65266 1.97363 14.19738 2.44244 1.76241.53489 1.85502.50959 2.22367-.60744.24279-.73566.28029-2.73516.14369-7.66053-.44788-16.149002-1.23751-19.911778-5.02917-23.965076-1.80821-1.932978-3.56225-2.973051-7.11557-4.219231-5.30124-1.859191-12.26098-2.569875-19.19872-1.960452-10.49153.921594-19.993865 2.573896-30.430988 5.291456l-5.619006 1.463045-.198978-.992725C76.31239 78.136699 76.217381 74.401849 76.210696 70.38303l-.01215-7.306943 3.356503-1.444983c10.517529-4.527823 21.216871-6.656502 37.293351-7.419665 12.51101-.593907 22.76653.582675 29.54824 3.389974 4.64166 1.921419 7.46417 3.920688 11.49419 8.14168 5.92808 6.208991 7.10885 9.292714 7.94906 20.759878.20234 2.761617.35353 19.385439.44083 48.471489l.13286 44.26837-6.87266-.008c-7.35796-.009-10.40797-.26157-11.45694-.94889-1.06894-.70039-1.56607-2.17132-2.37024-7.01314-.41845-2.51943-.81979-4.63975-.89185-4.71182-.0721-.0721-.94053.61073-1.92991 1.51732-2.61666 2.39769-6.17638 4.67392-11.10375 7.10019-7.00303 3.44832-13.15672 5.41292-19.90153 6.35366-4.14851.57862-11.25229.52696-14.85996-.10807zM117.9586 163.14859c7.66738-1.41157 14.24402-3.97835 21.89691-8.5461l3.72858-2.22546v-12.58107c0-11.74762-.0314-12.59038-.47455-12.72168-1.42309-.42168-10.77757-1.80215-14.1221-2.08405-4.68265-.39467-14.28993-.18758-17.80807.38387-8.70887 1.41459-13.028171 3.55254-15.811026 7.82606-2.230704 3.42561-3.30745 7.4555-3.304504 12.36763.0032 5.38208 1.685615 10.33001 4.555689 13.39835 1.872987 2.00238 6.082191 3.96008 9.779001 4.54822 2.10281.33454 8.92935.11855 11.56007-.36577z" transform="scale(0.26458333)"/></svg></span></a><button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/aws-controllers-k8s/community><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav flex-grow-1 main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://aws-controllers-k8s.github.io/community/docs/community/overview/>Documentation</a></li><li class=nav-item><a class=nav-link href=https://aws-controllers-k8s.github.io/community/reference/>API Reference</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-introduction aria-expanded=true>
Introduction</button><div class="collapse show" id=section-introduction><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/overview/>Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/how-it-works/>How it Works</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/services/>Services</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/releases/>Release Phases</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-getting-started aria-expanded=true>
Getting Started</button><div class="collapse show" id=section-getting-started><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/install/>Install an ACK Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/irsa/>Configure IAM Permissions</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/resource-crud/>Create an ACK Resource</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/multi-region-resource-management/>Manage Resources In Multiple Regions</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/cross-account-resource-management/>Manage Resources In Multiple AWS Accounts</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/authorization/>Permissions Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/authentication/>Authentication and Credentials</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/field-export/>Copy a resource field into a ConfigMap or Secret</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/adopted-resource/>Adopting Existing AWS Resources</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/ack-tags/>Managing Tags on your AWS Resources</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/openshift/>Red Hat OpenShift</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/user-docs/cleanup/>Uninstall an ACK Controller</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-tutorials aria-expanded=true>
Tutorials</button><div class="collapse show" id=section-tutorials><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/sagemaker-example/>Machine Learning with the ACK SageMaker Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/autoscaling-example/>Scale SageMaker Workloads with Application Auto Scaling</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/rds-example/>Deploy PostgreSQL, MySQL, MariaDB Instances Using the ACK RDS Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/apigatewayv2-reference-example/>Manage HTTP APIs with the ACK APIGatewayv2 Controller</a></li><li><a class="docs-link rounded active" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/memorydb-example/>Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/aurora-serverless-v2/>Manage an Aurora Serverless v2 cluster with the ACK RDS Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/tutorials/lambda-oci-example/>Create a Lambda Function with OCI Image with the ACK Lambda Controller</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-contributor aria-expanded=true>
Contributor Docs</button><div class="collapse show" id=section-contributor><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/overview/>Contribution Overview</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/tenets/>Project Tenets</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/code-generation/>Code Generation</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/code-organization/>Code Organization</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/operatorhub-onboarding/>OperatorHub Onboarding</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/api-inference/>API Inference</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/setup/>Setup</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/building-controller/>Building a Controller</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/testing/>Testing</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/contributor-docs/release/>Release</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-discussion aria-expanded=true>
Discussion</button><div class="collapse show" id=section-discussion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/background/>Background</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/faq/>FAQ</a></li><li><a class="docs-link rounded" href=https://aws-controllers-k8s.github.io/community/docs/community/discussions/>Discussions</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><hr><span class=small><nav id=TableOfContents><ul><li><a href=#setup>Setup</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#install-the-ack-service-controller-for-amazon-memorydb>Install the ACK service controller for Amazon MemoryDB</a></li><li><a href=#configure-iam-permissions>Configure IAM permissions</a></li></ul></li><li><a href=#create-amazon-memorydb-cluster-instances>Create Amazon MemoryDB Cluster Instances</a><ul><li><a href=#amazon-memorydb-cluster>Amazon MemoryDB Cluster</a></li></ul></li><li><a href=#connect-to-amazon-memorydb-cluster>Connect to Amazon MemoryDB Cluster</a></li><li><a href=#next-steps>Next steps</a><ul><li><a href=#cleanup>Cleanup</a></li></ul></li></ul></nav></span></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Create a managed Amazon MemoryDB for Redis Cluster using the ACK MemoryDB Controller</h1><p class=lead>Create and use a managed Amazon MemoryDB for Redis Cluster using ACK MemoryDB Controller directly from Kubernetes</p><p>The ACK service controller for Amazon MemoryDB for Redis lets you manage Amazon MemoryDB Cluster directly from Kubernetes.
This guide will show you how to create a <a href=https://aws.amazon.com/memorydb/>Amazon MemoryDB for Redis</a> Cluster using Kubernetes resource manifest.</p><p>In this tutorial we will install ACK service controller for Amazon MemoryDB for Redis on an Amazon EKS Cluster. We configure IAM permissions for the controller to invoke Amazon MemoryDB API. We create Amazon MemoryDB Cluster instances. We also deploy a sample POD on the Amazon EKS Cluster to connect to the Amazon MemoryDB Cluster instance from the POD.</p><h2 id=setup>Setup<a href=#setup class=anchor aria-hidden=true>#</a></h2><p>Although it is not necessary to use Amazon Elastic Kubernetes Service (Amazon EKS) with ACK, this guide assumes that you have access to an Amazon EKS cluster. If this is your first time creating an Amazon EKS cluster, see <a href=https://docs.aws.amazon.com/deep-learning-containers/latest/devguide/deep-learning-containers-eks-setup.html>Amazon EKS Setup</a>. For automated cluster creation using <code>eksctl</code>, see <a href=https://docs.aws.amazon.com/eks/latest/userguide/getting-started-eksctl.html>Getting started with Amazon EKS - <code>eksctl</code></a> and create your cluster with Amazon EC2 Linux managed nodes.</p><h3 id=prerequisites>Prerequisites<a href=#prerequisites class=anchor aria-hidden=true>#</a></h3><p>This guide assumes that you have:</p><ul><li>Created an EKS cluster with Kubernetes version 1.18 or higher.</li><li>Setup the <a href=https://docs.aws.amazon.com/eks/latest/userguide/managing-vpc-cni.html>Amazon VPC Container Network Interface (CNI) plugin for Kubernetes</a> for the EKS Cluster.</li><li>AWS IAM permissions to create roles and attach policies to roles.</li><li>Installed the following tools on the client machine used to access your Kubernetes cluster:<ul><li><a href=https://docs.aws.amazon.com/cli/latest/userguide/install-cliv1.html>AWS CLI</a> - A command line tool for interacting with AWS services.</li><li><a href=https://docs.aws.amazon.com/eks/latest/userguide/install-kubectl.html>kubectl</a> - A command line tool for working with Kubernetes clusters.</li><li><a href=https://docs.aws.amazon.com/eks/latest/userguide/eksctl.html>eksctl</a> - A command line tool for working with EKS clusters.</li><li><a href=https://helm.sh/docs/intro/install/>Helm 3.8+</a> - A tool for installing and managing Kubernetes applications.</li></ul></li></ul><h3 id=install-the-ack-service-controller-for-amazon-memorydb>Install the ACK service controller for Amazon MemoryDB<a href=#install-the-ack-service-controller-for-amazon-memorydb class=anchor aria-hidden=true>#</a></h3><p>You can deploy the ACK service controller for Amazon MemoryDB using the <a href=https://gallery.ecr.aws/aws-controllers-k8s/memorydb-chart>memorydb-chart Helm chart</a>.</p><p>Log into the Helm registry that stores the ACK charts:</p><pre><code class=language-bash>aws ecr-public get-login-password --region us-east-1 | helm registry login --username AWS --password-stdin public.ecr.aws
</code></pre><p>You can install the Helm chart to deploy the ACK service controller for Amazon MemoryDB to your EKS cluster. At a minimum, you need to specify the AWS Region to execute the Amazon MemoryDB API calls.</p><p>For example, to specify that the Amazon MemoryDB API calls go to the <code>us-east-1</code> region, you can deploy the service controller with the following command:</p><pre><code class=language-bash>helm install --create-namespace -n ack-system oci://public.ecr.aws/aws-controllers-k8s/memorydb-chart --version=v0.0.1 --generate-name --set=aws.region=us-east-1
</code></pre><p>For a full list of available values to the Helm chart, please <a href=https://github.com/aws-controllers-k8s/memorydb-controller/blob/main/helm/values.yaml>review the values.yaml file</a>.</p><h3 id=configure-iam-permissions>Configure IAM permissions<a href=#configure-iam-permissions class=anchor aria-hidden=true>#</a></h3><p>Once the service controller is deployed, you will need to <a href=../../user-docs/irsa/>configure the IAM permissions</a> for the controller to query the Amazon MemoryDB API. For full details, please review the AWS Controllers for Kubernetes documentation for <a href=../../user-docs/irsa/>how to configure the IAM permissions</a>. If you follow the examples in the documentation, use the value of <code>memorydb</code> for <code>SERVICE</code>.</p><h2 id=create-amazon-memorydb-cluster-instances>Create Amazon MemoryDB Cluster Instances<a href=#create-amazon-memorydb-cluster-instances class=anchor aria-hidden=true>#</a></h2><p>You can create Amazon MemoryDB Clusters using the <code>Cluster</code> custom resource. The examples below show how to deploy it from your Kubernetes environment. For a full list of options available in the <code>Cluster</code> custom resource definition, you can use <code>kubectl explain cluster</code> command.</p><h3 id=amazon-memorydb-cluster>Amazon MemoryDB Cluster<a href=#amazon-memorydb-cluster class=anchor aria-hidden=true>#</a></h3><p>To create a Amazon MemoryDB Cluster, create a <code>Cluster</code> custom resource. The examples below shows how to provision a Amazon MemoryDB Cluster :</p><ul><li>The first example creates a Amazon MemoryDB Cluster in default VPC</li><li>The second example creates a Amazon MemoryDB Cluster in specific VPC subnets and security groups.
You may choose any option from these examples.</li></ul><h4 id=create-amazon-memorydb-cluster-in-default-vpc>Create Amazon MemoryDB Cluster in default VPC<a href=#create-amazon-memorydb-cluster-in-default-vpc class=anchor aria-hidden=true>#</a></h4><p>The following YAML creates a MemoryDB Cluster using the default VPC subnets and security group.</p><pre><code class=language-bash>MEMORYDB_CLUSTER_NAME=&quot;example-memorydb-cluster&quot;

cat &lt;&lt;EOF &gt; memorydb-cluster.yaml
apiVersion: memorydb.services.k8s.aws/v1alpha1
kind: Cluster
metadata:
  name: &quot;${MEMORYDB_CLUSTER_NAME}&quot;
spec:
  name: &quot;${MEMORYDB_CLUSTER_NAME}&quot;
  nodeType: db.t4g.small
  aclName: open-access
EOF

kubectl apply -f memorydb-cluster.yaml
</code></pre><h4 id=create-amazon-memorydb-cluster-in-specific-vpc-subnets-and-security-groups>Create Amazon MemoryDB Cluster in specific VPC subnets and security groups<a href=#create-amazon-memorydb-cluster-in-specific-vpc-subnets-and-security-groups class=anchor aria-hidden=true>#</a></h4><p>To create a Amazon MemoryDB Cluster using specific subnets from a VPC, create a MemoryDB <code>SubnectGroup</code> custom resource first and then specify it, and a security group name, in the <code>Cluster</code> specification.</p><h5 id=create-amazon-memorydb-subnet-group>Create Amazon MemoryDB subnet group<a href=#create-amazon-memorydb-subnet-group class=anchor aria-hidden=true>#</a></h5><p>The following example uses the VPC ID of the EKS Cluster. You may specify any other VPC ID by updating the <code>VPC_ID</code> variable in the following example.</p><pre><code class=language-bash>EKS_CLUSTER_NAME=&quot;example-eks-cluster&quot;
AWS_REGION=&quot;us-east-1&quot;
VPC_ID=$(aws --region $AWS_REGION eks describe-cluster --name $EKS_CLUSTER_NAME --query cluster.resourcesVpcConfig.vpcId)
SUBNET_IDS=$(aws --region $AWS_REGION ec2 describe-subnets \
  --filters &quot;Name=vpc-id,Values=${VPC_ID}&quot; \
  --query 'Subnets[*].SubnetId' \
  --output text
)

MEMORYDB_SUBNETGROUP_NAME=&quot;example-subnet-group&quot;

cat &lt;&lt;EOF &gt; memorydb-subnetgroup.yaml
apiVersion: memorydb.services.k8s.aws/v1alpha1
kind: SubnetGroup
metadata:
  name: &quot;${MEMORYDB_SUBNETGROUP_NAME}&quot;
spec:
  name: &quot;${MEMORYDB_SUBNETGROUP_NAME}&quot;
  description: &quot;MemoryDB cluster subnet group&quot;
  subnetIDs:
$(printf &quot;    - %s\n&quot; ${SUBNET_IDS})

EOF

kubectl apply -f memorydb-subnetgroup.yaml
kubectl describe subnetgroup &quot;${MEMORYDB_SUBNETGROUP_NAME}&quot;
</code></pre><p>If you observe that the <code>ACK.Terminal</code> condition is set for the SubnetGroup and the error is similar to the following:</p><pre><code class=language-bash>Status:
  Conditions:
    Message:               SubnetNotAllowedFault: Subnets: [subnet-1d111111, subnet-27d22222] are not in a supported availability zone. Supported availability zones are [us-east-1c, us-east-1d, us-east-1b].
    Status:                True
    Type:                  ACK.Terminal
</code></pre><p>Then update the <code>subnetIDs</code> in the input YAML and provide the subnet Ids that are in a supported availability zone.</p><h5 id=create-amazon-memorydb-cluster>Create Amazon MemoryDB Cluster<a href=#create-amazon-memorydb-cluster class=anchor aria-hidden=true>#</a></h5><p>The following example uses the MemoryDB subnet group created above. It uses the provisioning EKS Cluster&rsquo;s security group. You may specify any other VPC security group by modifying the list of <code>securityGroupIDs</code> in the specification.
It uses the <code>db.t4g.small</code> node type for the MemoryDB cluster. Please review the <a href=https://docs.aws.amazon.com/memorydb/latest/devguide/nodes.supportedtypes.html>MemoryDB node types</a> to select the most appropriate one for your workload.</p><pre><code class=language-shell>EKS_CLUSTER_NAME=&quot;example-eks-cluster&quot;
MEMORYDB_CLUSTER_NAME=&quot;example-memorydb-cluster&quot;
AWS_REGION=&quot;us-east-1&quot;
SECURITY_GROUP_ID=$(aws --region $AWS_REGION eks describe-cluster --name $EKS_CLUSTER_NAME --query cluster.resourcesVpcConfig.clusterSecurityGroupId)

cat &lt;&lt;EOF &gt; memorydb-cluster.yaml
apiVersion: memorydb.services.k8s.aws/v1alpha1
kind: Cluster
metadata:
  name: &quot;${MEMORYDB_CLUSTER_NAME}&quot;
spec:
  name: &quot;${MEMORYDB_CLUSTER_NAME}&quot;
  nodeType: db.t4g.small
  aclName: open-access
  securityGroupIDs:
    - ${SECURITY_GROUP_ID}
  subnetGroupName: ${MEMORYDB_SUBNETGROUP_NAME}
EOF

kubectl apply -f memorydb-cluster.yaml
kubectl describe cluster &quot;${MEMORYDB_CLUSTER_NAME}&quot;
</code></pre><p>You can track the status of the provisioned database using <code>kubectl describe</code> on the <code>Cluster</code> custom resource:</p><pre><code class=language-bash>kubectl describe cluster &quot;${MEMORYDB_CLUSTER_NAME}&quot;
</code></pre><p>The output of the <em>Cluster</em> resource looks like:</p><pre><code class=language-bash>Name:         clusters
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  memorydb.services.k8s.aws/last-requested-node-type: db.t4g.medium
              memorydb.services.k8s.aws/last-requested-num-shards: 2
API Version:  memorydb.services.k8s.aws/v1alpha1
Kind:         Cluster
Metadata:
  Creation Timestamp:  2022-03-30T08:47:07Z
  Finalizers:
    finalizers.memorydb.services.k8s.aws/Cluster
  Generation:        5
  Resource Version:  158132376
  Self Link:         /apis/memorydb.services.k8s.aws/v1alpha1/namespaces/default/clusters/clusters
  UID:               2f6fc7ed-fe04-42cb-85bf-b7982dedec1c
Spec:
  Acl Name:                    open-access
  Auto Minor Version Upgrade:  true
  Engine Version:              6.2
  Maintenance Window:          sat:03:00-sat:04:00
  Name:                        clusters
  Node Type:                   db.t4g.medium
  Num Replicas Per Shard:      1
  Num Shards:                  2
  Parameter Group Name:        default.memorydb-redis6
  Snapshot Retention Limit:    0
  Snapshot Window:             05:30-06:30
  Subnet Group Name:           default
  Tls Enabled:                 true
Status:
  Ack Resource Metadata:
    Arn:               arn:aws:memorydb:us-east-1:************:cluster/clusters
    Owner Account ID:  ************
  Allowed Scale Down Node Types:
    db.t4g.small
  Allowed Scale Up Node Types:
    db.r6g.12xlarge
    db.r6g.16xlarge
    db.r6g.2xlarge
    db.r6g.4xlarge
    db.r6g.8xlarge
    db.r6g.large
    db.r6g.xlarge
  Cluster Endpoint:
    Address:  clustercfg.clusters.******.memorydb.us-east-1.amazonaws.com
    Port:     6379
  Conditions:
    Last Transition Time:  2022-04-06T22:05:25Z
    Message:               Resource synced successfully
    Reason:
    Status:                True
    Type:                  ACK.ResourceSynced
  Engine Patch Version:    6.2.4
  Number Of Shards:        2
  Parameter Group Status:  in-sync
  Shards:
    Name:  0001
    Nodes:
      Availability Zone:  us-east-1d
      Create Time:        2022-03-30T09:04:04Z
      Endpoint:
        Address:          clusters-0001-001.clusters.******.memorydb.us-east-1.amazonaws.com
        Port:             6379
      Name:               clusters-0001-001
      Status:             available
      Availability Zone:  us-east-1b
      Create Time:        2022-03-30T09:04:04Z
      Endpoint:
        Address:      clusters-0001-002.clusters.******.memorydb.us-east-1.amazonaws.com
        Port:         6379
      Name:           clusters-0001-002
      Status:         available
    Number Of Nodes:  2
    Slots:            0-8191
    Status:           available
    Name:             0002
    Nodes:
      Availability Zone:  us-east-1c
      Create Time:        2022-03-30T09:04:04Z
      Endpoint:
        Address:          clusters-0002-001.clusters.******.memorydb.us-east-1.amazonaws.com
        Port:             6379
      Name:               clusters-0002-001
      Status:             available
      Availability Zone:  us-east-1d
      Create Time:        2022-03-30T09:04:04Z
      Endpoint:
        Address:      clusters-0002-002.clusters.******.memorydb.us-east-1.amazonaws.com
        Port:         6379
      Name:           clusters-0002-002
      Status:         available
    Number Of Nodes:  2
    Slots:            8192-16383
    Status:           available
  Status:             available
Events:               &lt;none&gt;
</code></pre><p>When the <code>Cluster Status</code> says <code>available</code>, you can connect to the database instance.</p><h2 id=connect-to-amazon-memorydb-cluster>Connect to Amazon MemoryDB Cluster<a href=#connect-to-amazon-memorydb-cluster class=anchor aria-hidden=true>#</a></h2><blockquote><p>To connect to the MemoryDB Cluster from a Pod running inside Kubernetes cluster:</p><ul><li>Ensure that the <a href=https://docs.aws.amazon.com/eks/latest/userguide/managing-vpc-cni.html>Amazon VPC Container Network Interface (CNI) plugin for Kubernetes</a> has been setup for the EKS Cluster.</li><li>Review <a href=https://docs.aws.amazon.com/memorydb/latest/devguide/memorydb-vpc-accessing.html>access patterns for accessing a MemoryDB Cluster in an Amazon VPC</a> to confirm that MemoryDB cluster is configured to allow connection from the Pod.</li></ul></blockquote><p>The <code>Cluster</code> status contains the information for connecting to a Amazon MemoryDB for Redis Cluster. The host information can be found in <code>status.clusterEndpoint.address</code> and the port information can be found in <code>status.clusterEndpoint.port</code>. For example, you can get the connection information for a <code>Cluster</code> created in one of the previous examples using the following commands:</p><pre><code class=language-bash>kubectl get cluster &quot;${MEMORYDB_CLUSTER_NAME}&quot; -o jsonpath='{.status.clusterEndpoint.address}'
kubectl get cluster &quot;${MEMORYDB_CLUSTER_NAME}&quot; -o jsonpath='{.status.clusterEndpoint.port}'
</code></pre><p>You can extract this information and make it available to your Pods using a <a href=../../user-docs/field-export><code>FieldExport</code></a> resource. The following example makes the MemoryDB cluster endpoint and port available as ConfigMap data:</p><pre><code class=language-shell>MEMORYDB_CLUSTER_NAME=&quot;example-memorydb-cluster&quot;
MEMORYDB_CLUSTER_CONN_CM=&quot;${MEMORYDB_CLUSTER_NAME}-conn-cm&quot;

cat &lt;&lt;EOF &gt; memorydb-field-exports.yaml
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: ${MEMORYDB_CLUSTER_CONN_CM}
data: {}
---
apiVersion: services.k8s.aws/v1alpha1
kind: FieldExport
metadata:
  name: ${MEMORYDB_CLUSTER_NAME}-host
spec:
  to:
    name: ${MEMORYDB_CLUSTER_CONN_CM}
    kind: configmap
  from:
    path: &quot;.status.clusterEndpoint.address&quot;
    resource:
      group: memorydb.services.k8s.aws
      kind: Cluster
      name: ${MEMORYDB_CLUSTER_NAME}
---
apiVersion: services.k8s.aws/v1alpha1
kind: FieldExport
metadata:
  name: ${MEMORYDB_CLUSTER_NAME}-port
spec:
  to:
    name: ${MEMORYDB_CLUSTER_CONN_CM}
    kind: configmap
  from:
    path: &quot;.status.clusterEndpoint.port&quot;
    resource:
      group: memorydb.services.k8s.aws
      kind: Cluster
      name: ${MEMORYDB_CLUSTER_NAME}
EOF

kubectl apply -f memorydb-field-exports.yaml
</code></pre><p>Confirm that the Amazon MemoryDB endpoint details are available in the config map by running the following command.</p><pre><code class=language-shell>kubectl get configmap/${MEMORYDB_CLUSTER_CONN_CM} -o jsonpath='{.data}'
</code></pre><p>These values can be injected into a container either as environmental variables or files. For example, here is a snippet of a deployment definition that will add the Amazon MemoryDB Cluster connection info into a Pod:</p><pre><code class=language-shell>cat &lt;&lt;EOF &gt; game_leaderboard.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: leaderboard-deployment
  labels:
    app: leaderboard
spec:
  replicas: 1
  selector:
    matchLabels:
      app: leaderboard
  template:
    metadata:
      labels:
        app: leaderboard
    spec:
      containers:
      - name: leaderboard
        image: public.ecr.aws/sam/build-python3.8:latest
        tty: true
        stdin: true
        env:
          - name: MEMORYDB_CLUSTER_HOST
            valueFrom:
              configMapKeyRef:
                name: ${MEMORYDB_CLUSTER_CONN_CM}
                key: &quot;${MEMORYDB_CLUSTER_NAME}-host&quot;
          - name: MEMORYDB_CLUSTER_PORT
            valueFrom:
              configMapKeyRef:
                name: ${MEMORYDB_CLUSTER_CONN_CM}
                key: &quot;${MEMORYDB_CLUSTER_NAME}-port&quot;
EOF

kubectl apply -f game_leaderboard.yaml
</code></pre><p>Confirm that the leaderboard application container has been deployed successfully by running the following:</p><pre><code class=language-shell>kubectl get pods –selector=app=leaderboard
</code></pre><p>Verify that the Pod Status is <code>Running</code>.</p><p>Get a shell to the running leaderboard container.</p><pre><code class=language-shell>LEADERBOARD_POD_NAME=$(kubectl get pods –selector=app=leaderboard -o jsonpath='{.items[*].metadata.name}')
kubectl exec –stdin –tty ${LEADERBOARD_POD_NAME}  -- /bin/bash
</code></pre><p>In the running leaderboard container shell, run the following commands and confirm that the MemoryDB cluster host and port are available as environment variables.</p><pre><code class=language-shell># Confirm that the memorydb cluster host, port are available as environment variables
echo $MEMORYDB_CLUSTER_HOST
echo $MEMORYDB_CLUSTER_PORT
</code></pre><h2 id=next-steps>Next steps<a href=#next-steps class=anchor aria-hidden=true>#</a></h2><p>You can learn more about each of the ACK service controller for Amazon MemoryDB custom resources by using <code>kubectl explain</code> on the API resources. These include:</p><ul><li><code>cluster</code></li><li><code>user</code></li><li><code>acl</code></li><li><code>parametergroup</code></li><li><code>subnetgroup</code></li><li><code>snapshot</code></li></ul><p>The ACK service controller for Amazon MemoryDB is based on the <a href=https://docs.aws.amazon.com/memorydb/latest/APIReference/Welcome.html>Amazon MemoryDB API</a>. To get a full understanding of how all the APIs work, please review the <a href=https://docs.aws.amazon.com/memorydb/latest/APIReference/Welcome.html>Amazon MemoryDB API documentation</a>.</p><p>You can learn more about <a href=https://docs.aws.amazon.com/memorydb/index.html>how to use Amazon MemoryDB</a> through the <a href=https://docs.aws.amazon.com/memorydb/index.html>documentation</a>.</p><h3 id=cleanup>Cleanup<a href=#cleanup class=anchor aria-hidden=true>#</a></h3><p>You can deprovision your Amazon MemoryDB for Redis Cluster using <code>kubectl delete</code> command.</p><p>Following commands delete the resources that were created in this tutorial.</p><pre><code class=language-bash>kubectl delete -f game_leaderboard.yaml
kubectl delete -f memorydb-field-exports.yaml
kubectl delete -f memorydb-cluster.yaml
kubectl delete -f memorydb-subnetgroup.yaml
</code></pre><p>To remove the MemoryDB ACK service controller, related CRDs, and namespaces, see <a href=../../user-docs/cleanup/>ACK Cleanup</a>.</p><p>To delete your EKS clusters, see <a href=https://docs.aws.amazon.com/eks/latest/userguide/delete-cluster.html>Amazon EKS - Deleting a cluster</a>.</p><p class=edit-page><a href=https://github.com/aws-controllers-k8s/community/blob/main/docs/content/docs/tutorials/memorydb-example.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class=my-n3></div></main></div></div></div><footer class="footer mt-auto text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://aws-controllers-k8s.github.io/community/js/bootstrap.min.586171fec3966d1a44fa8aa2edb24b861dc3a72be8cc24aa4e0dabe4c312a0dae5fe1eaa7c93180a6211fa4d7c5461b0d228fdf741be2eae279a376dfa1e7d81.js integrity="sha512-WGFx/sOWbRpE+oqi7bJLhh3DpyvozCSqTg2r5MMSoNrl/h6qfJMYCmIR+k18VGGw0ij990G+Lq4nmjdt+h59gQ==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/js/highlight.min.b9c3f53f62ede0586acf2866d3772ea55bf34115611a96523af51b289a2a58f9f60b82ffd4103276a6adc1a3bc7113c6ead0cf0799144d35605ff1e9108981bc.js integrity="sha512-ucP1P2Lt4Fhqzyhm03cupVvzQRVhGpZSOvUbKJoqWPn2C4L/1BAydqatwaO8cRPG6tDPB5kUTTVgX/HpEImBvA==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/main.min.491f43bd0e1cabe525a61ecfcb2738d89c578585b04b9ebbaf9d125b55595f3b76e5497375a1da0c840e16966c9a910aae60fba0790088c7869bee07c3be997c.js integrity="sha512-SR9DvQ4cq+Ulph7Pyyc42JxXhYWwS567r50SW1VZXzt25UlzdaHaDIQOFpZsmpEKrmD7oHkAiMeGm+4Hw76ZfA==" crossorigin=anonymous defer></script>
<script src=https://aws-controllers-k8s.github.io/community/index.min.e05363254040f459f05581ae88607f20b2fc42208892dbcb0e526a24a38ac37469a01f6a205587755c09282c7f229524967d999b45d7a425c1b13d23dd65f2dd.js integrity="sha512-4FNjJUBA9FnwVYGuiGB/ILL8QiCIktvLDlJqJKOKw3RpoB9qIFWHdVwJKCx/IpUkln2Zm0XXpCXBsT0j3WXy3Q==" crossorigin=anonymous defer></script></body></html>